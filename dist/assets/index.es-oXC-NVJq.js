function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-PbSghA_E.js","assets/index-KjuOU1pg.js","assets/index-BDefbu_F.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{u as Tt,v as ou,w as to,y as au,z as rh,D as po,F as jm,G as Um,J as fo,K as lt,L as rt,P as sh,Q as nh,T as A,U as le,V as Vn,W as oh,X as ah,Y as Lm,Z as ch,$ as cu,a0 as ds,a1 as Mm,a2 as km,a3 as zm,a4 as xi,a5 as Vm,a6 as G,a7 as lr,a8 as Hm,a9 as uu,aa as Km,ab as Fm,ac as At,ad as Gm,ae as go,af as yo,ag as vs,ah as vo,ai as Gt,aj as $t,ak as cr,al as Bm,am as Wm,an as Qm,_ as Jm}from"./index-KjuOU1pg.js";const Ym={Accept:"application/json","Content-Type":"application/json"},Zm="POST",hu={headers:Ym,method:Zm},lu=10;class Jt{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new Tt.EventEmitter,this.isAvailable=!1,this.registering=!1,!ou(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,i){this.isAvailable||await this.register();try{const n=to(r),h=await(await au(this.url,Object.assign(Object.assign({},hu),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!ou(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=to({id:1,jsonrpc:"2.0",method:"test",params:[]});await au(r,Object.assign(Object.assign({},hu),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?rh(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),h=po(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return jm(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>lu&&this.events.setMaxListeners(lu)}}const Xm=":";function ew(a){const[r,i]=a.split(Xm);return{namespace:r,reference:i}}function tw(a,r=[]){const i=[];return Object.keys(a).forEach(n=>{if(r.length&&!r.includes(n))return;const o=a[n];i.push(...o.accounts)}),i}function uh(a,r){return a.includes(":")?[a]:r.chains||[]}const hh="base10",De="base16",io="base64pad",mo="utf8",lh=0,ci=1,iw=0,pu=1,ro=12,wo=32;function rw(){const a=oh.generateKeyPair();return{privateKey:rt(a.secretKey,De),publicKey:rt(a.publicKey,De)}}function so(){const a=ah.randomBytes(wo);return rt(a,De)}function sw(a,r){const i=oh.sharedKey(lt(a,De),lt(r,De),!0),n=new Lm(fo.SHA256,i).expand(wo);return rt(n,De)}function nw(a){const r=fo.hash(lt(a,De));return rt(r,De)}function Ni(a){const r=fo.hash(lt(a,mo));return rt(r,De)}function ow(a){return lt(`${a}`,hh)}function pr(a){return Number(rt(a,hh))}function aw(a){const r=ow(typeof a.type<"u"?a.type:lh);if(pr(r)===ci&&typeof a.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const i=typeof a.senderPublicKey<"u"?lt(a.senderPublicKey,De):void 0,n=typeof a.iv<"u"?lt(a.iv,De):ah.randomBytes(ro),o=new ch.ChaCha20Poly1305(lt(a.symKey,De)).seal(n,lt(a.message,mo));return uw({type:r,sealed:o,iv:n,senderPublicKey:i})}function cw(a){const r=new ch.ChaCha20Poly1305(lt(a.symKey,De)),{sealed:i,iv:n}=fs(a.encoded),o=r.open(n,i);if(o===null)throw new Error("Failed to decrypt");return rt(o,mo)}function uw(a){if(pr(a.type)===ci){if(typeof a.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return rt(cu([a.type,a.senderPublicKey,a.iv,a.sealed]),io)}return rt(cu([a.type,a.iv,a.sealed]),io)}function fs(a){const r=lt(a,io),i=r.slice(iw,pu),n=pu;if(pr(i)===ci){const y=n+wo,w=y+ro,S=r.slice(n,y),N=r.slice(y,w),O=r.slice(w);return{type:i,sealed:O,iv:N,senderPublicKey:S}}const o=n+ro,h=r.slice(n,o),d=r.slice(o);return{type:i,sealed:d,iv:h}}function hw(a,r){const i=fs(a);return ph({type:pr(i.type),senderPublicKey:typeof i.senderPublicKey<"u"?rt(i.senderPublicKey,De):void 0,receiverPublicKey:r==null?void 0:r.receiverPublicKey})}function ph(a){const r=(a==null?void 0:a.type)||lh;if(r===ci){if(typeof(a==null?void 0:a.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(a==null?void 0:a.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:r,senderPublicKey:a==null?void 0:a.senderPublicKey,receiverPublicKey:a==null?void 0:a.receiverPublicKey}}function du(a){return a.type===ci&&typeof a.senderPublicKey=="string"&&typeof a.receiverPublicKey=="string"}var lw=Object.defineProperty,fu=Object.getOwnPropertySymbols,pw=Object.prototype.hasOwnProperty,dw=Object.prototype.propertyIsEnumerable,gu=(a,r,i)=>r in a?lw(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,yu=(a,r)=>{for(var i in r||(r={}))pw.call(r,i)&&gu(a,i,r[i]);if(fu)for(var i of fu(r))dw.call(r,i)&&gu(a,i,r[i]);return a};const fw="ReactNative",Be={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},gw="js";function _o(){return typeof Vn<"u"&&typeof Vn.versions<"u"&&typeof Vn.versions.node<"u"}function $i(){return!nh()&&!!sh()&&navigator.product===fw}function Ti(){return!_o()&&!!sh()&&!!nh()}function dr(){return $i()?Be.reactNative:_o()?Be.node:Ti()?Be.browser:Be.unknown}function yw(){var a;try{return $i()&&typeof le<"u"&&typeof(le==null?void 0:le.Application)<"u"?(a=le.Application)==null?void 0:a.applicationId:void 0}catch{return}}function vw(a,r){let i=ds.parse(a);return i=yu(yu({},i),r),a=ds.stringify(i),a}function mw(){return Um()||{name:"",description:"",url:"",icons:[""]}}function ww(){if(dr()===Be.reactNative&&typeof le<"u"&&typeof(le==null?void 0:le.Platform)<"u"){const{OS:i,Version:n}=le.Platform;return[i,n].join("-")}const a=Mm();if(a===null)return"unknown";const r=a.os?a.os.replace(" ","").toLowerCase():"unknown";return a.type==="browser"?[r,a.name,a.version].join("-"):[r,a.version].join("-")}function _w(){var a;const r=dr();return r===Be.browser?[r,((a=km())==null?void 0:a.host)||"unknown"].join(":"):r}function bw(a,r,i){const n=ww(),o=_w();return[[a,r].join("-"),[gw,i].join("-"),n,o].join("/")}function Ew({protocol:a,version:r,relayUrl:i,sdkVersion:n,auth:o,projectId:h,useOnCloseEvent:d,bundleId:y}){const w=i.split("?"),S=bw(a,r,n),N={auth:o,ua:S,projectId:h,useOnCloseEvent:d||void 0,origin:y||void 0},O=vw(w[1]||"",N);return w[0]+"?"+O}function ai(a,r){return a.filter(i=>r.includes(i)).length===a.length}function dh(a){return Object.fromEntries(a.entries())}function fh(a){return new Map(Object.entries(a))}function Oi(a=A.FIVE_MINUTES,r){const i=A.toMiliseconds(a||A.FIVE_MINUTES);let n,o,h;return{resolve:d=>{h&&n&&(clearTimeout(h),n(d))},reject:d=>{h&&o&&(clearTimeout(h),o(d))},done:()=>new Promise((d,y)=>{h=setTimeout(()=>{y(new Error(r))},i),n=d,o=y})}}function ur(a,r,i){return new Promise(async(n,o)=>{const h=setTimeout(()=>o(new Error(i)),r);try{const d=await a;n(d)}catch(d){o(d)}clearTimeout(h)})}function gh(a,r){if(typeof r=="string"&&r.startsWith(`${a}:`))return r;if(a.toLowerCase()==="topic"){if(typeof r!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${r}`}else if(a.toLowerCase()==="id"){if(typeof r!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${r}`}throw new Error(`Unknown expirer target type: ${a}`)}function Iw(a){return gh("topic",a)}function Pw(a){return gh("id",a)}function yh(a){const[r,i]=a.split(":"),n={id:void 0,topic:void 0};if(r==="topic"&&typeof i=="string")n.topic=i;else if(r==="id"&&Number.isInteger(Number(i)))n.id=Number(i);else throw new Error(`Invalid target, expected id:number or topic:string, got ${r}:${i}`);return n}function Ge(a,r){return A.fromMiliseconds((r||Date.now())+A.toMiliseconds(a))}function Bt(a){return Date.now()>=A.toMiliseconds(a)}function ge(a,r){return`${a}${r?`:${r}`:""}`}function Hn(a=[],r=[]){return[...new Set([...a,...r])]}async function Sw({id:a,topic:r,wcDeepLink:i}){try{if(!i)return;const n=typeof i=="string"?JSON.parse(i):i;let o=n==null?void 0:n.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const h=`${o}/wc?requestId=${a}&sessionTopic=${r}`,d=dr();d===Be.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):d===Be.reactNative&&typeof(le==null?void 0:le.Linking)<"u"&&await le.Linking.openURL(h)}catch(n){console.error(n)}}async function Rw(a,r){try{return await a.getItem(r)||(Ti()?localStorage.getItem(r):void 0)}catch(i){console.error(i)}}const Ow="irn";function no(a){return(a==null?void 0:a.relay)||{protocol:Ow}}function ps(a){const r=zm[a];if(typeof r>"u")throw new Error(`Relay Protocol not supported: ${a}`);return r}var Cw=Object.defineProperty,Nw=Object.defineProperties,xw=Object.getOwnPropertyDescriptors,vu=Object.getOwnPropertySymbols,$w=Object.prototype.hasOwnProperty,Tw=Object.prototype.propertyIsEnumerable,mu=(a,r,i)=>r in a?Cw(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Aw=(a,r)=>{for(var i in r||(r={}))$w.call(r,i)&&mu(a,i,r[i]);if(vu)for(var i of vu(r))Tw.call(r,i)&&mu(a,i,r[i]);return a},Dw=(a,r)=>Nw(a,xw(r));function qw(a,r="-"){const i={},n="relay"+r;return Object.keys(a).forEach(o=>{if(o.startsWith(n)){const h=o.replace(n,""),d=a[o];i[h]=d}}),i}function wu(a){a=a.includes("wc://")?a.replace("wc://",""):a,a=a.includes("wc:")?a.replace("wc:",""):a;const r=a.indexOf(":"),i=a.indexOf("?")!==-1?a.indexOf("?"):void 0,n=a.substring(0,r),o=a.substring(r+1,i).split("@"),h=typeof i<"u"?a.substring(i):"",d=ds.parse(h);return{protocol:n,topic:jw(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:qw(d),expiryTimestamp:d.expiryTimestamp?parseInt(d.expiryTimestamp,10):void 0}}function jw(a){return a.startsWith("//")?a.substring(2):a}function Uw(a,r="-"){const i="relay",n={};return Object.keys(a).forEach(o=>{const h=i+r+o;a[o]&&(n[h]=a[o])}),n}function Lw(a){return`${a.protocol}:${a.topic}@${a.version}?`+ds.stringify(Dw(Aw({symKey:a.symKey},Uw(a.relay)),{expiryTimestamp:a.expiryTimestamp}))}function Ai(a){const r=[];return a.forEach(i=>{const[n,o]=i.split(":");r.push(`${n}:${o}`)}),r}function Mw(a){const r=[];return Object.values(a).forEach(i=>{r.push(...Ai(i.accounts))}),r}function kw(a,r){const i=[];return Object.values(a).forEach(n=>{Ai(n.accounts).includes(r)&&i.push(...n.methods)}),i}function zw(a,r){const i=[];return Object.values(a).forEach(n=>{Ai(n.accounts).includes(r)&&i.push(...n.events)}),i}function bo(a){return a.includes(":")}function nr(a){return bo(a)?a.split(":")[0]:a}const Vw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Hw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function R(a,r){const{message:i,code:n}=Hw[a];return{message:r?`${i} ${r}`:i,code:n}}function ae(a,r){const{message:i,code:n}=Vw[a];return{message:r?`${i} ${r}`:i,code:n}}function vt(a,r){return Array.isArray(a)?typeof r<"u"&&a.length?a.every(r):!0:!1}function hr(a){return Object.getPrototypeOf(a)===Object.prototype&&Object.keys(a).length}function Ae(a){return typeof a>"u"}function _e(a,r){return r&&Ae(a)?!0:typeof a=="string"&&!!a.trim().length}function Eo(a,r){return r&&Ae(a)?!0:typeof a=="number"&&!isNaN(a)}function Kw(a,r){const{requiredNamespaces:i}=r,n=Object.keys(a.namespaces),o=Object.keys(i);let h=!0;return ai(o,n)?(n.forEach(d=>{const{accounts:y,methods:w,events:S}=a.namespaces[d],N=Ai(y),O=i[d];(!ai(uh(d,O),N)||!ai(O.methods,w)||!ai(O.events,S))&&(h=!1)}),h):!1}function gs(a){return _e(a,!1)&&a.includes(":")?a.split(":").length===2:!1}function Fw(a){if(_e(a,!1)&&a.includes(":")){const r=a.split(":");if(r.length===3){const i=r[0]+":"+r[1];return!!r[2]&&gs(i)}}return!1}function Gw(a){if(_e(a,!1))try{return typeof new URL(a)<"u"}catch{return!1}return!1}function Bw(a){var r;return(r=a==null?void 0:a.proposer)==null?void 0:r.publicKey}function Ww(a){return a==null?void 0:a.topic}function Qw(a,r){let i=null;return _e(a==null?void 0:a.publicKey,!1)||(i=R("MISSING_OR_INVALID",`${r} controller public key should be a string`)),i}function _u(a){let r=!0;return vt(a)?a.length&&(r=a.every(i=>_e(i,!1))):r=!1,r}function Jw(a,r,i){let n=null;return vt(r)&&r.length?r.forEach(o=>{n||gs(o)||(n=ae("UNSUPPORTED_CHAINS",`${i}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):gs(a)||(n=ae("UNSUPPORTED_CHAINS",`${i}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Yw(a,r,i){let n=null;return Object.entries(a).forEach(([o,h])=>{if(n)return;const d=Jw(o,uh(o,h),`${r} ${i}`);d&&(n=d)}),n}function Zw(a,r){let i=null;return vt(a)?a.forEach(n=>{i||Fw(n)||(i=ae("UNSUPPORTED_ACCOUNTS",`${r}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):i=ae("UNSUPPORTED_ACCOUNTS",`${r}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),i}function Xw(a,r){let i=null;return Object.values(a).forEach(n=>{if(i)return;const o=Zw(n==null?void 0:n.accounts,`${r} namespace`);o&&(i=o)}),i}function e0(a,r){let i=null;return _u(a==null?void 0:a.methods)?_u(a==null?void 0:a.events)||(i=ae("UNSUPPORTED_EVENTS",`${r}, events should be an array of strings or empty array for no events`)):i=ae("UNSUPPORTED_METHODS",`${r}, methods should be an array of strings or empty array for no methods`),i}function vh(a,r){let i=null;return Object.values(a).forEach(n=>{if(i)return;const o=e0(n,`${r}, namespace`);o&&(i=o)}),i}function t0(a,r,i){let n=null;if(a&&hr(a)){const o=vh(a,r);o&&(n=o);const h=Yw(a,r,i);h&&(n=h)}else n=R("MISSING_OR_INVALID",`${r}, ${i} should be an object with data`);return n}function Kn(a,r){let i=null;if(a&&hr(a)){const n=vh(a,r);n&&(i=n);const o=Xw(a,r);o&&(i=o)}else i=R("MISSING_OR_INVALID",`${r}, namespaces should be an object with data`);return i}function mh(a){return _e(a.protocol,!0)}function i0(a,r){let i=!1;return r&&!a?i=!0:a&&vt(a)&&a.length&&a.forEach(n=>{i=mh(n)}),i}function r0(a){return typeof a=="number"}function Me(a){return typeof a<"u"&&typeof a!==null}function s0(a){return!(!a||typeof a!="object"||!a.code||!Eo(a.code,!1)||!a.message||!_e(a.message,!1))}function n0(a){return!(Ae(a)||!_e(a.method,!1))}function o0(a){return!(Ae(a)||Ae(a.result)&&Ae(a.error)||!Eo(a.id,!1)||!_e(a.jsonrpc,!1))}function a0(a){return!(Ae(a)||!_e(a.name,!1))}function bu(a,r){return!(!gs(r)||!Mw(a).includes(r))}function c0(a,r,i){return _e(i,!1)?kw(a,r).includes(i):!1}function u0(a,r,i){return _e(i,!1)?zw(a,r).includes(i):!1}function Eu(a,r,i){let n=null;const o=h0(a),h=l0(r),d=Object.keys(o),y=Object.keys(h),w=Iu(Object.keys(a)),S=Iu(Object.keys(r)),N=w.filter(O=>!S.includes(O));return N.length&&(n=R("NON_CONFORMING_NAMESPACES",`${i} namespaces keys don't satisfy requiredNamespaces.
      Required: ${N.toString()}
      Received: ${Object.keys(r).toString()}`)),ai(d,y)||(n=R("NON_CONFORMING_NAMESPACES",`${i} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${y.toString()}`)),Object.keys(r).forEach(O=>{if(!O.includes(":")||n)return;const T=Ai(r[O].accounts);T.includes(O)||(n=R("NON_CONFORMING_NAMESPACES",`${i} namespaces accounts don't satisfy namespace accounts for ${O}
        Required: ${O}
        Approved: ${T.toString()}`))}),d.forEach(O=>{n||(ai(o[O].methods,h[O].methods)?ai(o[O].events,h[O].events)||(n=R("NON_CONFORMING_NAMESPACES",`${i} namespaces events don't satisfy namespace events for ${O}`)):n=R("NON_CONFORMING_NAMESPACES",`${i} namespaces methods don't satisfy namespace methods for ${O}`))}),n}function h0(a){const r={};return Object.keys(a).forEach(i=>{var n;i.includes(":")?r[i]=a[i]:(n=a[i].chains)==null||n.forEach(o=>{r[o]={methods:a[i].methods,events:a[i].events}})}),r}function Iu(a){return[...new Set(a.map(r=>r.includes(":")?r.split(":")[0]:r))]}function l0(a){const r={};return Object.keys(a).forEach(i=>{if(i.includes(":"))r[i]=a[i];else{const n=Ai(a[i].accounts);n==null||n.forEach(o=>{r[o]={accounts:a[i].accounts.filter(h=>h.includes(`${o}:`)),methods:a[i].methods,events:a[i].events}})}}),r}function p0(a,r){return Eo(a,!1)&&a<=r.max&&a>=r.min}function Pu(){const a=dr();return new Promise(r=>{switch(a){case Be.browser:r(d0());break;case Be.reactNative:r(f0());break;case Be.node:r(g0());break;default:r(!0)}})}function d0(){return Ti()&&(navigator==null?void 0:navigator.onLine)}async function f0(){if($i()&&typeof le<"u"&&le!=null&&le.NetInfo){const a=await(le==null?void 0:le.NetInfo.fetch());return a==null?void 0:a.isConnected}return!0}function g0(){return!0}function y0(a){switch(dr()){case Be.browser:v0(a);break;case Be.reactNative:m0(a);break}}function v0(a){!$i()&&Ti()&&(window.addEventListener("online",()=>a(!0)),window.addEventListener("offline",()=>a(!1)))}function m0(a){var r;$i()&&typeof le<"u"&&le!=null&&le.NetInfo&&((r=le)==null||r.NetInfo.addEventListener(i=>a(i==null?void 0:i.isConnected)))}const Fn={};let cs=class{static get(r){return Fn[r]}static set(r,i){Fn[r]=i}static delete(r){delete Fn[r]}};class w0 extends xi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class _0 extends xi{constructor(r,i){super(),this.core=r,this.logger=i,this.records=new Map}}class b0{constructor(r,i){this.logger=r,this.core=i}}let E0=class extends xi{constructor(r,i){super(),this.relayer=r,this.logger=i}},I0=class extends xi{constructor(r){super()}},P0=class{constructor(r,i,n,o){this.core=r,this.logger=i,this.name=n}};class S0 extends xi{constructor(r,i){super(),this.relayer=r,this.logger=i}}let R0=class extends xi{constructor(r,i){super(),this.core=r,this.logger=i}},O0=class{constructor(r,i){this.projectId=r,this.logger=i}},C0=class{constructor(r,i){this.projectId=r,this.logger=i}};class N0{constructor(r){this.opts=r,this.protocol="wc",this.version=2}}let x0=class{constructor(r){this.client=r}};var $0={};function T0(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),d=h.charCodeAt(0);if(i[d]!==255)throw new TypeError(h+" is ambiguous");i[d]=o}var y=a.length,w=a.charAt(0),S=Math.log(y)/Math.log(256),N=Math.log(256)/Math.log(y);function O(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var Z=0,se=0,ee=0,Oe=U.length;ee!==Oe&&U[ee]===0;)ee++,Z++;for(var ne=(Oe-ee)*N+1>>>0,te=new Uint8Array(ne);ee!==Oe;){for(var B=U[ee],me=0,pe=ne-1;(B!==0||me<se)&&pe!==-1;pe--,me++)B+=256*te[pe]>>>0,te[pe]=B%y>>>0,B=B/y>>>0;if(B!==0)throw new Error("Non-zero carry");se=me,ee++}for(var Ce=ne-se;Ce!==ne&&te[Ce]===0;)Ce++;for(var qt=w.repeat(Z);Ce<ne;++Ce)qt+=a.charAt(te[Ce]);return qt}function T(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var Z=0;if(U[Z]!==" "){for(var se=0,ee=0;U[Z]===w;)se++,Z++;for(var Oe=(U.length-Z)*S+1>>>0,ne=new Uint8Array(Oe);U[Z];){var te=i[U.charCodeAt(Z)];if(te===255)return;for(var B=0,me=Oe-1;(te!==0||B<ee)&&me!==-1;me--,B++)te+=y*ne[me]>>>0,ne[me]=te%256>>>0,te=te/256>>>0;if(te!==0)throw new Error("Non-zero carry");ee=B,Z++}if(U[Z]!==" "){for(var pe=Oe-ee;pe!==Oe&&ne[pe]===0;)pe++;for(var Ce=new Uint8Array(se+(Oe-pe)),qt=se;pe!==Oe;)Ce[qt++]=ne[pe++];return Ce}}}function J(U){var Z=T(U);if(Z)return Z;throw new Error(`Non-${r} character`)}return{encode:O,decodeUnsafe:T,decode:J}}var A0=T0,D0=A0;const wh=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},q0=a=>new TextEncoder().encode(a),j0=a=>new TextDecoder().decode(a);class U0{constructor(r,i,n){this.name=r,this.prefix=i,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class L0{constructor(r,i,n){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return _h(this,r)}}class M0{constructor(r){this.decoders=r}or(r){return _h(this,r)}decode(r){const i=r[0],n=this.decoders[i];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _h=(a,r)=>new M0({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class k0{constructor(r,i,n,o){this.name=r,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new U0(r,i,n),this.decoder=new L0(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const ms=({name:a,prefix:r,encode:i,decode:n})=>new k0(a,r,i,n),fr=({prefix:a,name:r,alphabet:i})=>{const{encode:n,decode:o}=D0(i,r);return ms({prefix:a,name:r,encode:n,decode:h=>wh(o(h))})},z0=(a,r,i,n)=>{const o={};for(let N=0;N<r.length;++N)o[r[N]]=N;let h=a.length;for(;a[h-1]==="=";)--h;const d=new Uint8Array(h*i/8|0);let y=0,w=0,S=0;for(let N=0;N<h;++N){const O=o[a[N]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<i|O,y+=i,y>=8&&(y-=8,d[S++]=255&w>>y)}if(y>=i||255&w<<8-y)throw new SyntaxError("Unexpected end of data");return d},V0=(a,r,i)=>{const n=r[r.length-1]==="=",o=(1<<i)-1;let h="",d=0,y=0;for(let w=0;w<a.length;++w)for(y=y<<8|a[w],d+=8;d>i;)d-=i,h+=r[o&y>>d];if(d&&(h+=r[o&y<<i-d]),n)for(;h.length*i&7;)h+="=";return h},Ie=({name:a,prefix:r,bitsPerChar:i,alphabet:n})=>ms({prefix:r,name:a,encode(o){return V0(o,n,i)},decode(o){return z0(o,n,i,a)}}),H0=ms({prefix:"\0",name:"identity",encode:a=>j0(a),decode:a=>q0(a)});var K0=Object.freeze({__proto__:null,identity:H0});const F0=Ie({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var G0=Object.freeze({__proto__:null,base2:F0});const B0=Ie({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var W0=Object.freeze({__proto__:null,base8:B0});const Q0=fr({prefix:"9",name:"base10",alphabet:"0123456789"});var J0=Object.freeze({__proto__:null,base10:Q0});const Y0=Ie({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Z0=Ie({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var X0=Object.freeze({__proto__:null,base16:Y0,base16upper:Z0});const e_=Ie({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),t_=Ie({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i_=Ie({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),r_=Ie({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),s_=Ie({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),n_=Ie({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),o_=Ie({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),a_=Ie({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),c_=Ie({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var u_=Object.freeze({__proto__:null,base32:e_,base32upper:t_,base32pad:i_,base32padupper:r_,base32hex:s_,base32hexupper:n_,base32hexpad:o_,base32hexpadupper:a_,base32z:c_});const h_=fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),l_=fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var p_=Object.freeze({__proto__:null,base36:h_,base36upper:l_});const d_=fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),f_=fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var g_=Object.freeze({__proto__:null,base58btc:d_,base58flickr:f_});const y_=Ie({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),v_=Ie({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),m_=Ie({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),w_=Ie({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var __=Object.freeze({__proto__:null,base64:y_,base64pad:v_,base64url:m_,base64urlpad:w_});const bh=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),b_=bh.reduce((a,r,i)=>(a[i]=r,a),[]),E_=bh.reduce((a,r,i)=>(a[r.codePointAt(0)]=i,a),[]);function I_(a){return a.reduce((r,i)=>(r+=b_[i],r),"")}function P_(a){const r=[];for(const i of a){const n=E_[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(n)}return new Uint8Array(r)}const S_=ms({prefix:"🚀",name:"base256emoji",encode:I_,decode:P_});var R_=Object.freeze({__proto__:null,base256emoji:S_}),O_=Eh,Su=128,C_=127,N_=~C_,x_=Math.pow(2,31);function Eh(a,r,i){r=r||[],i=i||0;for(var n=i;a>=x_;)r[i++]=a&255|Su,a/=128;for(;a&N_;)r[i++]=a&255|Su,a>>>=7;return r[i]=a|0,Eh.bytes=i-n+1,r}var $_=oo,T_=128,Ru=127;function oo(a,n){var i=0,n=n||0,o=0,h=n,d,y=a.length;do{if(h>=y)throw oo.bytes=0,new RangeError("Could not decode varint");d=a[h++],i+=o<28?(d&Ru)<<o:(d&Ru)*Math.pow(2,o),o+=7}while(d>=T_);return oo.bytes=h-n,i}var A_=Math.pow(2,7),D_=Math.pow(2,14),q_=Math.pow(2,21),j_=Math.pow(2,28),U_=Math.pow(2,35),L_=Math.pow(2,42),M_=Math.pow(2,49),k_=Math.pow(2,56),z_=Math.pow(2,63),V_=function(a){return a<A_?1:a<D_?2:a<q_?3:a<j_?4:a<U_?5:a<L_?6:a<M_?7:a<k_?8:a<z_?9:10},H_={encode:O_,decode:$_,encodingLength:V_},Ih=H_;const Ou=(a,r,i=0)=>(Ih.encode(a,r,i),r),Cu=a=>Ih.encodingLength(a),ao=(a,r)=>{const i=r.byteLength,n=Cu(a),o=n+Cu(i),h=new Uint8Array(o+i);return Ou(a,h,0),Ou(i,h,n),h.set(r,o),new K_(a,i,r,h)};class K_{constructor(r,i,n,o){this.code=r,this.size=i,this.digest=n,this.bytes=o}}const Ph=({name:a,code:r,encode:i})=>new F_(a,r,i);class F_{constructor(r,i,n){this.name=r,this.code=i,this.encode=n}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?ao(this.code,i):i.then(n=>ao(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Sh=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),G_=Ph({name:"sha2-256",code:18,encode:Sh("SHA-256")}),B_=Ph({name:"sha2-512",code:19,encode:Sh("SHA-512")});var W_=Object.freeze({__proto__:null,sha256:G_,sha512:B_});const Rh=0,Q_="identity",Oh=wh,J_=a=>ao(Rh,Oh(a)),Y_={code:Rh,name:Q_,encode:Oh,digest:J_};var Z_=Object.freeze({__proto__:null,identity:Y_});new TextEncoder,new TextDecoder;const Nu={...K0,...G0,...W0,...J0,...X0,...u_,...p_,...g_,...__,...R_};({...W_,...Z_});function Ch(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function X_(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ch(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Nh(a,r,i,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:i},decoder:{decode:n}}}const xu=Nh("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),Gn=Nh("ascii","a",a=>{let r="a";for(let i=0;i<a.length;i++)r+=String.fromCharCode(a[i]);return r},a=>{a=a.substring(1);const r=X_(a.length);for(let i=0;i<a.length;i++)r[i]=a.charCodeAt(i);return r}),eb={utf8:xu,"utf-8":xu,hex:Nu.base16,latin1:Gn,ascii:Gn,binary:Gn,...Nu};function tb(a,r="utf8"){const i=eb[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ch(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const xh="wc",ib=2,Io="core",Wt=`${xh}@2:${Io}:`,rb={name:Io,logger:"error"},sb={database:":memory:"},nb="crypto",$u="client_ed25519_seed",ob=A.ONE_DAY,ab="keychain",cb="0.3",ub="messages",hb="0.3",lb=A.SIX_HOURS,pb="publisher",$h="irn",db="error",Th="wss://relay.walletconnect.com",Tu="wss://relay.walletconnect.org",fb="relayer",Re={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},gb="_subscription",Ct={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},yb=A.ONE_SECOND,vb="2.11.1",mb=1e4,wb="0.3",_b="WALLETCONNECT_CLIENT_ID",ht={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},bb="subscription",Eb="0.3",Ib=A.FIVE_SECONDS*1e3,Pb="pairing",Sb="0.3",ir={wc_pairingDelete:{req:{ttl:A.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:A.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:A.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:A.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:A.ONE_DAY,prompt:!1,tag:0},res:{ttl:A.ONE_DAY,prompt:!1,tag:0}}},or={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},yt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Rb="history",Ob="0.3",Cb="expirer",it={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Nb="0.3",Bn="verify-api",Ci="https://verify.walletconnect.com",co="https://verify.walletconnect.org",xb=[Ci,co],$b="echo",Tb="https://echo.walletconnect.com";class Ab{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=ab,this.version=cb,this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=R("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=G.generateChildLogger(i,this.name)}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,dh(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?fh(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Db{constructor(r,i,n){this.core=r,this.logger=i,this.name=nb,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=uu(o);return Km(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=rw();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),d=uu(h),y=so();return await Fm(y,o,ob,d)},this.generateSharedKey=(o,h,d)=>{this.isInitialized();const y=this.getPrivateKey(o),w=sw(y,h);return this.setSymKey(w,d)},this.setSymKey=async(o,h)=>{this.isInitialized();const d=h||nw(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,d)=>{this.isInitialized();const y=ph(d),w=to(h);if(du(y)){const T=y.senderPublicKey,J=y.receiverPublicKey;o=await this.generateSharedKey(T,J)}const S=this.getSymKey(o),{type:N,senderPublicKey:O}=y;return aw({type:N,symKey:S,message:w,senderPublicKey:O})},this.decode=async(o,h,d)=>{this.isInitialized();const y=hw(h,d);if(du(y)){const w=y.receiverPublicKey,S=y.senderPublicKey;o=await this.generateSharedKey(w,S)}try{const w=this.getSymKey(o),S=cw({symKey:w,encoded:h});return rh(S)}catch(w){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(w)}},this.getPayloadType=o=>{const h=fs(o);return pr(h.type)},this.getPayloadSenderPublicKey=o=>{const h=fs(o);return h.senderPublicKey?rt(h.senderPublicKey,De):void 0},this.core=r,this.logger=G.generateChildLogger(i,this.name),this.keychain=n||new Ab(this.core,this.logger)}get context(){return G.getLoggerContext(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get($u)}catch{r=so(),await this.keychain.set($u,r)}return tb(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class qb extends b0{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=ub,this.version=hb,this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=Ni(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=o,this.messages.set(n,d),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),d=Ni(o);return typeof h[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=G.generateChildLogger(r,this.name),this.core=i}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,dh(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?fh(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class jb extends E0{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new Tt.EventEmitter,this.name=pb,this.queue=new Map,this.publishTimeout=A.toMiliseconds(A.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const y=(h==null?void 0:h.ttl)||lb,w=no(h),S=(h==null?void 0:h.prompt)||!1,N=(h==null?void 0:h.tag)||0,O=(h==null?void 0:h.id)||Wm().toString(),T={topic:n,message:o,opts:{ttl:y,relay:w,prompt:S,tag:N,id:O}},J=setTimeout(()=>this.queue.set(O,T),this.publishTimeout);try{await await ur(this.rpcPublish(n,o,y,w,S,N,O),this.publishTimeout,`Failed to publish payload, please try again. id:${O} tag:${N}`),this.removeRequestFromQueue(O),this.relayer.events.emit(Re.publish,T)}catch(U){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=h==null?void 0:h.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(O),U;return}finally{clearTimeout(J)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=G.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return G.getLoggerContext(this.logger)}rpcPublish(r,i,n,o,h,d,y){var w,S,N,O;const T={method:ps(o.protocol).publish,params:{topic:r,message:i,ttl:n,prompt:h,tag:d},id:y};return Ae((w=T.params)==null?void 0:w.prompt)&&((S=T.params)==null||delete S.prompt),Ae((N=T.params)==null?void 0:N.tag)&&((O=T.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:T}),this.relayer.request(T)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:n,opts:o}=r;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(lr.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Re.connection_stalled);return}this.checkQueue()}),this.relayer.on(Re.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class Ub{constructor(){this.map=new Map,this.set=(r,i)=>{const n=this.get(r);this.exists(r,i)||this.map.set(r,[...n,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,i))return;const o=n.filter(h=>h!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Lb=Object.defineProperty,Mb=Object.defineProperties,kb=Object.getOwnPropertyDescriptors,Au=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,Du=(a,r,i)=>r in a?Lb(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,rr=(a,r)=>{for(var i in r||(r={}))zb.call(r,i)&&Du(a,i,r[i]);if(Au)for(var i of Au(r))Vb.call(r,i)&&Du(a,i,r[i]);return a},Wn=(a,r)=>Mb(a,kb(r));class Hb extends S0{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new Ub,this.events=new Tt.EventEmitter,this.name=bb,this.version=Eb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Wt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=no(o),d={topic:n,relay:h};this.pending.set(n,d);const y=await this.rpcSubscribe(n,h);return this.onSubscribe(y,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),y}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>{if(this.topics.includes(n))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${n}`;return await new Promise((h,d)=>{const y=new A.Watch;y.start(o);const w=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(w),y.stop(o),h(!0)),y.elapsed(o)>=Ib&&(clearInterval(w),y.stop(o),d(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=G.generateChildLogger(i,this.name),this.clientId=""}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let n=!1;try{n=this.getSubscription(r).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}});try{const o=no(n);await this.rpcUnsubscribe(r,i,o);const h=ae("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const n={method:ps(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}return Ni(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,n={method:ps(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}}rpcUnsubscribe(r,i,n){const o={method:ps(n.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,Wn(rr({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,rr({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,rr({},i)),this.topicMap.set(i.topic,r),this.events.emit(ht.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:n}=R("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(ht.deleted,Wn(rr({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ht.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(ht.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);vt(i)&&this.onBatchSubscribe(i.map((n,o)=>Wn(rr({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(lr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Re.connect,async()=>{await this.onConnect()}),this.relayer.on(Re.disconnect,()=>{this.onDisconnect()}),this.events.on(ht.created,async r=>{const i=ht.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(ht.deleted,async r=>{const i=ht.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var Kb=Object.defineProperty,qu=Object.getOwnPropertySymbols,Fb=Object.prototype.hasOwnProperty,Gb=Object.prototype.propertyIsEnumerable,ju=(a,r,i)=>r in a?Kb(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Bb=(a,r)=>{for(var i in r||(r={}))Fb.call(r,i)&&ju(a,i,r[i]);if(qu)for(var i of qu(r))Gb.call(r,i)&&ju(a,i,r[i]);return a};class Wb extends I0{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Tt.EventEmitter,this.name=fb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async i=>{this.logger.debug("Publishing Request Payload");const n=i.id,o=this.provider.request(i);this.requestsInFlight.set(n,{promise:o,request:i});try{return await this.toEstablishConnection(),await o}catch(h){throw this.logger.debug("Failed to Publish Request"),this.logger.error(h),h}finally{this.requestsInFlight.delete(n)}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(Re.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(Re.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ct.payload,this.onPayloadHandler),this.provider.on(Ct.connect,this.onConnectHandler),this.provider.on(Ct.disconnect,this.onDisconnectHandler),this.provider.on(Ct.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?G.generateChildLogger(r.logger,this.name):G.pino(G.getDefaultLoggerOptions({level:r.logger||db})),this.messages=new qb(this.logger,r.core),this.subscriber=new Hb(this,this.logger),this.publisher=new jb(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Th,this.projectId=r.projectId,this.bundleId=yw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Tu}...`),await this.restartTransport(Tu)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},mb)}get context(){return G.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,n){this.isInitialized(),await this.publisher.publish(r,i,n),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";if(o)return o;let h;const d=y=>{y.topic===r&&(this.subscriber.off(ht.created,d),h())};return await Promise.all([new Promise(y=>{h=y,this.subscriber.on(ht.created,d)}),new Promise(async y=>{o=await this.subscriber.subscribe(r,i),y()})]),o}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async r=>{await r.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ur(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once(ht.resubscribed,()=>{i()})}),new Promise(async(i,n)=>{try{await ur(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}i()})])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.provider.events.emit(Ct.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Pu())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new At(new Gm(Ew({sdkVersion:vb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:n}=r;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(r){const{topic:i,message:n}=r;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const o=this.messages.has(i,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),go(r)){if(!r.method.endsWith(gb))return;const i=r.params,{topic:n,message:o,publishedAt:h}=i.data,d={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Bb({type:"event",event:i.id},d)),this.events.emit(i.id,d),await this.acknowledgePayload(r),await this.onMessageEvent(d)}else yo(r)&&this.events.emit(Re.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Re.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=vs(r.id,!0);await this.provider.connection.send(i)}unregisterProviderListeners(){this.provider.off(Ct.payload,this.onPayloadHandler),this.provider.off(Ct.connect,this.onConnectHandler),this.provider.off(Ct.disconnect,this.onDisconnectHandler),this.provider.off(Ct.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Re.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let r=await Pu();y0(async i=>{this.initialized&&r!==i&&(r=i,i?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Re.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},A.toMiliseconds(yb)))}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Qb=Object.defineProperty,Uu=Object.getOwnPropertySymbols,Jb=Object.prototype.hasOwnProperty,Yb=Object.prototype.propertyIsEnumerable,Lu=(a,r,i)=>r in a?Qb(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Mu=(a,r)=>{for(var i in r||(r={}))Jb.call(r,i)&&Lu(a,i,r[i]);if(Uu)for(var i of Uu(r))Yb.call(r,i)&&Lu(a,i,r[i]);return a};class ws extends P0{constructor(r,i,n,o=Wt,h=void 0){super(r,i,n,o),this.core=r,this.logger=i,this.name=n,this.map=new Map,this.version=wb,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!Ae(d)?this.map.set(this.getKey(d),d):Bw(d)?this.map.set(d.id,d):Ww(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,y)=>{this.isInitialized(),this.map.has(d)?await this.update(d,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:y}),this.map.set(d,y),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(y=>Object.keys(d).every(w=>Vm(y[w],d[w]))):this.values),this.update=async(d,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:y});const w=Mu(Mu({},this.getData(d)),y);this.map.set(d,w),await this.persist()},this.delete=async(d,y)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:y}),this.map.delete(d),await this.persist())},this.logger=G.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:n}=R("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Zb{constructor(r,i){this.core=r,this.logger=i,this.name=Pb,this.version=Sb,this.events=new vo,this.initialized=!1,this.storagePrefix=Wt,this.ignoredPayloadTypes=[ci],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=so(),o=await this.core.crypto.setSymKey(n),h=Ge(A.FIVE_MINUTES),d={protocol:$h},y={topic:o,expiry:h,relay:d,active:!1},w=Lw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d,expiryTimestamp:h});return await this.pairings.set(o,y),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:d,expiryTimestamp:y}=wu(n.uri);let w;if(this.pairings.keys.includes(o)&&(w=this.pairings.get(o),w.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const S=y||Ge(A.FIVE_MINUTES),N={topic:o,relay:d,expiry:S,active:!1};return await this.pairings.set(o,N),this.core.expirer.set(o,S),n.activatePairing&&await this.activate({topic:o}),this.events.emit(or.create,N),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:d})),N},this.activate=async({topic:n})=>{this.isInitialized();const o=Ge(A.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:y,reject:w}=Oi();this.events.once(ge("pairing_ping",h),({error:S})=>{S?w(S):y()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",ae("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const d=cr(o,h),y=await this.core.crypto.encode(n,d),w=ir[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,y,w),d.id},this.sendResult=async(n,o,h)=>{const d=vs(n,h),y=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),S=ir[w.request.method].res;await this.core.relayer.publish(o,y,S),await this.core.history.resolve(d)},this.sendError=async(n,o,h)=>{const d=po(n,h),y=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),S=ir[w.request.method]?ir[w.request.method].res:ir.unregistered_method.res;await this.core.relayer.publish(o,y,S),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,ae("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>Bt(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,d=(await this.core.history.get(o,h.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(or.ping,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{Gt(o)?this.events.emit(ge("pairing_ping",h),{}):$t(o)&&this.events.emit(ge("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(or.delete,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:d}=o;try{if(this.registeredMethods.includes(d))return;const y=ae("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,n,y),this.logger.error(y)}catch(y){await this.sendError(h,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(ae("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!Me(n)){const{message:d}=R("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(d)}if(!Gw(n.uri)){const{message:d}=R("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(d)}const h=wu(n.uri);if(!((o=h==null?void 0:h.relay)!=null&&o.protocol)){const{message:d}=R("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(h!=null&&h.symKey)){const{message:d}=R("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}if(h!=null&&h.expiryTimestamp&&A.toMiliseconds(h==null?void 0:h.expiryTimestamp)<Date.now()){const{message:d}=R("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(d)}},this.isValidPing=async n=>{if(!Me(n)){const{message:h}=R("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!Me(n)){const{message:h}=R("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!_e(n,!1)){const{message:o}=R("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=R("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(Bt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=R("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=G.generateChildLogger(i,this.name),this.pairings=new ws(this.core,this.logger,this.name,this.storagePrefix)}get context(){return G.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Re.message,async r=>{const{topic:i,message:n}=r;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);try{go(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(it.expired,async r=>{const{topic:i}=yh(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit(or.expire,{topic:i}))})}}class Xb extends _0{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new Tt.EventEmitter,this.name=Rb,this.version=Ob,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Ge(A.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(yt.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=$t(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(yt.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(yt.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=G.generateChildLogger(i,this.name)}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:cr(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:n}=R("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(yt.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(yt.created,r=>{const i=yt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(yt.updated,r=>{const i=yt.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(yt.deleted,r=>{const i=yt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(lr.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{A.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class e1 extends R0{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new Tt.EventEmitter,this.name=Cb,this.version=Nb,this.cached=[],this.initialized=!1,this.storagePrefix=Wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),d={target:h,expiry:o};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(it.created,{target:h,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(it.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=G.generateChildLogger(i,this.name)}get context(){return G.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return Iw(r);if(typeof r=="number")return Pw(r);const{message:i}=R("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(it.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:n}=R("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(r,i){const{expiry:n}=i;A.toMiliseconds(n)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(it.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(lr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(it.created,r=>{const i=it.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(it.expired,r=>{const i=it.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(it.deleted,r=>{const i=it.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}}}class t1 extends O0{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=Bn,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||$i()||!Ti())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=co;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let h;try{h=await this.fetchAttestation(n.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(d),h=await this.fetchAttestation(n.attestationId,co)}return h},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const h=this.startAbortTimer(A.ONE_SECOND*2),d=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(h=>{if(document.getElementById(Bn))return h();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=Bn,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=h}),new Promise((h,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},A.toMiliseconds(A.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||Ci;return xb.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Ci}`),o=Ci),o},this.logger=G.generateChildLogger(i,this.name),this.verifyUrl=Ci,this.abortController=new AbortController,this.isDevEnv=_o()&&$0.IS_VITEST}get context(){return G.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),A.toMiliseconds(r))}}class i1 extends C0{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.context=$b,this.registerDeviceToken=async n=>{const{clientId:o,token:h,notificationType:d,enableEncrypted:y=!1}=n,w=`${Tb}/${this.projectId}/clients`;await Bm(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:h,always_raw:y})})},this.logger=G.generateChildLogger(i,this.context)}}var r1=Object.defineProperty,ku=Object.getOwnPropertySymbols,s1=Object.prototype.hasOwnProperty,n1=Object.prototype.propertyIsEnumerable,zu=(a,r,i)=>r in a?r1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Vu=(a,r)=>{for(var i in r||(r={}))s1.call(r,i)&&zu(a,i,r[i]);if(ku)for(var i of ku(r))n1.call(r,i)&&zu(a,i,r[i]);return a};class Po extends w0{constructor(r){super(r),this.protocol=xh,this.version=ib,this.name=Io,this.events=new Tt.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Th,this.customStoragePrefix=r!=null&&r.customStoragePrefix?`:${r.customStoragePrefix}`:"";const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:G.pino(G.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||rb.logger}));this.logger=G.generateChildLogger(i,this.name),this.heartbeat=new lr.HeartBeat,this.crypto=new Db(this,this.logger,r==null?void 0:r.keychain),this.history=new Xb(this,this.logger),this.expirer=new e1(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new Hm(Vu(Vu({},sb),r==null?void 0:r.storageOptions)),this.relayer=new Wb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Zb(this,this.logger),this.verify=new t1(this.projectId||"",this.logger),this.echoClient=new i1(this.projectId||"",this.logger)}static async init(r){const i=new Po(r);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(_b,n),i}get context(){return G.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const o1=Po,Ah="wc",Dh=2,qh="client",So=`${Ah}@${Dh}:${qh}:`,Qn={name:qh,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Hu="WALLETCONNECT_DEEPLINK_CHOICE",a1="proposal",jh="Proposal expired",c1="session",us=A.SEVEN_DAYS,u1="engine",Nt={wc_sessionPropose:{req:{ttl:A.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:A.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:A.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:A.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:A.ONE_DAY,prompt:!1,tag:1104},res:{ttl:A.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:A.ONE_DAY,prompt:!1,tag:1106},res:{ttl:A.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:A.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:A.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:A.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:A.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:A.ONE_DAY,prompt:!1,tag:1112},res:{ttl:A.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:A.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:A.THIRTY_SECONDS,prompt:!1,tag:1115}}},Jn={min:A.FIVE_MINUTES,max:A.SEVEN_DAYS},xt={idle:"IDLE",active:"ACTIVE"},h1="request",l1=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var p1=Object.defineProperty,d1=Object.defineProperties,f1=Object.getOwnPropertyDescriptors,Ku=Object.getOwnPropertySymbols,g1=Object.prototype.hasOwnProperty,y1=Object.prototype.propertyIsEnumerable,Fu=(a,r,i)=>r in a?p1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Te=(a,r)=>{for(var i in r||(r={}))g1.call(r,i)&&Fu(a,i,r[i]);if(Ku)for(var i of Ku(r))y1.call(r,i)&&Fu(a,i,r[i]);return a},Ri=(a,r)=>d1(a,f1(r));class v1 extends x0{constructor(r){super(r),this.name=u1,this.events=new vo,this.initialized=!1,this.ignoredPayloadTypes=[ci],this.requestQueue={state:xt.idle,queue:[]},this.sessionRequestQueue={state:xt.idle,queue:[]},this.requestQueueDelay=A.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Nt)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},A.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const n=Ri(Te({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:y,relays:w}=n;let S=o,N,O=!1;if(S&&(O=this.client.core.pairing.pairings.get(S).active),!S||!O){const{topic:te,uri:B}=await this.client.core.pairing.create();S=te,N=B}const T=await this.client.core.crypto.generateKeyPair(),J=Nt.wc_sessionPropose.req.ttl||A.FIVE_MINUTES,U=Ge(J),Z=Te({requiredNamespaces:h,optionalNamespaces:d,relays:w??[{protocol:$h}],proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:U},y&&{sessionProperties:y}),{reject:se,resolve:ee,done:Oe}=Oi(J,jh);if(this.events.once(ge("session_connect"),async({error:te,session:B})=>{if(te)se(te);else if(B){B.self.publicKey=T;const me=Ri(Te({},B),{requiredNamespaces:Z.requiredNamespaces,optionalNamespaces:Z.optionalNamespaces});await this.client.session.set(B.topic,me),await this.setExpiry(B.topic,B.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:B.peer.metadata}),ee(me)}}),!S){const{message:te}=R("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(te)}const ne=await this.sendRequest({topic:S,method:"wc_sessionPropose",params:Z,throwOnFailedPublish:!0});return await this.setProposal(ne,Te({id:ne},Z)),{uri:N,approval:Oe}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:d}=i,y=this.client.proposal.get(n);let{pairingTopic:w,proposer:S,requiredNamespaces:N,optionalNamespaces:O}=y;w=w||"";const T=await this.client.core.crypto.generateKeyPair(),J=S.publicKey,U=await this.client.core.crypto.generateSharedKey(T,J);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:S.metadata}),await this.sendResult({id:n,topic:w,result:{relay:{protocol:o??"irn"},responderPublicKey:T}}),await this.client.proposal.delete(n,ae("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const Z=Te({relay:{protocol:o??"irn"},namespaces:h,pairingTopic:w,controller:{publicKey:T,metadata:this.client.metadata},expiry:Ge(us)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(U);const se=Ri(Te({},Z),{topic:U,requiredNamespaces:N,optionalNamespaces:O,pairingTopic:w,acknowledged:!1,self:Z.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:T});await this.client.session.set(U,se);try{await this.sendRequest({topic:U,method:"wc_sessionSettle",params:Z,throwOnFailedPublish:!0})}catch(ee){throw this.client.logger.error(ee),this.client.session.delete(U,ae("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(U),ee}return await this.setExpiry(U,Ge(us)),{topic:U,acknowledged:()=>new Promise(ee=>setTimeout(()=>ee(this.client.session.get(U)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,ae("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:y,reject:w}=Oi();return this.events.once(ge("session_update",h),({error:S})=>{S?w(S):y()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:d,reject:y}=Oi();return this.events.once(ge("session_extend",o),({error:w})=>{w?y(w):d()}),await this.setExpiry(n,Ge(us)),{acknowledged:h}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:h,expiry:d=Nt.wc_sessionRequest.req.ttl}=i,y=Qm(),{done:w,resolve:S,reject:N}=Oi(d,"Request expired. Please try again.");return this.events.once(ge("session_request",y),({error:O,result:T})=>{O?N(O):S(T)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:y,topic:h,method:"wc_sessionRequest",params:{request:Ri(Te({},o),{expiryTimestamp:Ge(d)}),chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(T=>N(T)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:y}),O()}),new Promise(async O=>{const T=await Rw(this.client.core.storage,Hu);Sw({id:y,topic:h,wcDeepLink:T}),O()}),w()]).then(O=>O[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:h}=o;Gt(o)?await this.sendResult({id:h,topic:n,result:o.result,throwOnFailedPublish:!0}):$t(o)&&await this.sendError(h,n,o.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:d,reject:y}=Oi();this.events.once(ge("session_ping",o),({error:w})=>{w?y(w):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:h}=i;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:ae("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:o}=R("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(o)}},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>Kw(n,i))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var d,y;return((d=h.peerMetadata)==null?void 0:d.url)&&((y=h.peerMetadata)==null?void 0:y.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async i=>{const{topic:n,expirerHasDeleted:o=!1,emitEvent:h=!0,id:d=0}=i,{self:y}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,ae("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(y.publicKey)&&await this.client.core.crypto.deleteKeyPair(y.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),o||this.client.core.expirer.del(n),this.client.core.storage.removeItem(Hu).catch(w=>this.client.logger.warn(w)),this.getPendingSessionRequests().forEach(w=>{w.topic===n&&this.deletePendingSessionRequest(w.id,ae("USER_DISCONNECTED"))}),h&&this.client.events.emit("session_delete",{id:d,topic:n})},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,ae("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==i),o&&(this.sessionRequestQueue.state=xt.idle,this.client.events.emit("session_request_expire",{id:i}))},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,Ge(Nt.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async i=>{const{id:n,topic:o,params:h,verifyContext:d}=i,y=h.request.expiryTimestamp||Ge(Nt.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(n,{id:n,topic:o,params:h,verifyContext:d}),y&&this.client.core.expirer.set(n,y)},this.sendRequest=async i=>{const{topic:n,method:o,params:h,expiry:d,relayRpcId:y,clientRpcId:w,throwOnFailedPublish:S}=i,N=cr(o,h,w);if(Ti()&&l1.includes(o)){const J=Ni(JSON.stringify(N));this.client.core.verify.register({attestationId:J})}const O=await this.client.core.crypto.encode(n,N),T=Nt[o].req;return d&&(T.ttl=d),y&&(T.id=y),this.client.core.history.set(n,N),S?(T.internal=Ri(Te({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,O,T)):this.client.core.relayer.publish(n,O,T).catch(J=>this.client.logger.error(J)),N.id},this.sendResult=async i=>{const{id:n,topic:o,result:h,throwOnFailedPublish:d}=i,y=vs(n,h),w=await this.client.core.crypto.encode(o,y),S=await this.client.core.history.get(o,n),N=Nt[S.request.method].res;d?(N.internal=Ri(Te({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,w,N)):this.client.core.relayer.publish(o,w,N).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(y)},this.sendError=async(i,n,o)=>{const h=po(i,o),d=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,i),w=Nt[y.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{let h=!1;Bt(o.expiry)&&(h=!0),this.client.core.crypto.keychain.has(o.topic)||(h=!0),h&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Bt(o.expiryTimestamp)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession({topic:o})),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===xt.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=xt.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=xt.idle},this.processRequest=i=>{const{topic:n,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=R("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(Te({},n.params));const d=o.expiryTimestamp||Ge(Nt.wc_sessionPropose.req.ttl),y=Te({id:h,pairingTopic:i,expiryTimestamp:d},o);await this.setProposal(h,y);const w=Ni(JSON.stringify(n)),S=await this.getVerifyContext(w,y.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:y,verifyContext:S})}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(Gt(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const y=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const w=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const S=await this.client.core.crypto.generateSharedKey(y,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const N=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:N}),await this.client.core.pairing.activate({topic:i})}else $t(n)&&(await this.client.proposal.delete(o,ae("USER_DISCONNECTED")),this.events.emit(ge("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:y,expiry:w,namespaces:S,sessionProperties:N,pairingTopic:O}=n.params,T=Te({topic:i,relay:d,expiry:w,namespaces:S,acknowledged:!0,pairingTopic:O,requiredNamespaces:{},optionalNamespaces:{},controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},N&&{sessionProperties:N});await this.sendResult({id:n.id,topic:i,result:!0}),this.events.emit(ge("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;Gt(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(ge("session_approve",o),{})):$t(n)&&(await this.client.session.delete(i,ae("USER_DISCONNECTED")),this.events.emit(ge("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:h}=n;try{const d=`${i}_session_update`,y=cs.get(d);if(y&&this.isRequestOutOfSync(y,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(Te({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:i,result:!0}),this.client.events.emit("session_update",{id:h,topic:i,params:o}),cs.set(d,h)}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(i,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;Gt(n)?this.events.emit(ge("session_update",o),{}):$t(n)&&this.events.emit(ge("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Ge(us)),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;Gt(n)?this.events.emit(ge("session_extend",o),{}):$t(n)&&this.events.emit(ge("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{Gt(n)?this.events.emit(ge("session_ping",o),{}):$t(n)&&this.events.emit(ge("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Re.publish,async()=>{h(await this.deleteSession({topic:i,id:o}))})}),this.sendResult({id:o,topic:i,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:i,error:ae("USER_DISCONNECTED")})])}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(Te({topic:i},h));const d=Ni(JSON.stringify(cr("wc_sessionRequest",h,o))),y=this.client.session.get(i),w=await this.getVerifyContext(d,y.peer.metadata),S={id:o,topic:i,params:h,verifyContext:w};await this.setPendingSessionRequest(S),this.addSessionRequestToSessionRequestQueue(S),this.processSessionRequestQueue()}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;Gt(n)?this.events.emit(ge("session_request",o),{result:n.result}):$t(n)&&this.events.emit(ge("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:h}=n;try{const d=`${i}_session_event_${h.event.name}`,y=cs.get(d);if(y&&this.isRequestOutOfSync(y,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(Te({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h}),cs.set(d,o)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=xt.idle,this.processSessionRequestQueue()},A.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:i,error:n})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(h=>h.topic===i&&h.request.method==="wc_sessionRequest").forEach(h=>{this.events.emit(ge("session_request",h.request.id),{error:n})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===xt.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=xt.active,this.client.events.emit("session_request",i)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=i=>{if(i.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===i.topic);n&&this.onSessionProposeRequest(i.topic,cr("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async i=>{if(!Me(i)){const{message:w}=R("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:d,relays:y}=i;if(Ae(n)||await this.isValidPairingTopic(n),!i0(y,!0)){const{message:w}=R("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(w)}!Ae(o)&&hr(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ae(h)&&hr(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),Ae(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=t0(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!Me(i))throw new Error(R("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:d}=i;await this.isValidProposalId(n);const y=this.client.proposal.get(n),w=Kn(o,"approve()");if(w)throw new Error(w.message);const S=Eu(y.requiredNamespaces,o,"approve()");if(S)throw new Error(S.message);if(!_e(h,!0)){const{message:N}=R("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(N)}Ae(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async i=>{if(!Me(i)){const{message:h}=R("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!s0(o)){const{message:h}=R("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!Me(i)){const{message:S}=R("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(S)}const{relay:n,controller:o,namespaces:h,expiry:d}=i;if(!mh(n)){const{message:S}=R("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const y=Qw(o,"onSessionSettleRequest()");if(y)throw new Error(y.message);const w=Kn(h,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(Bt(d)){const{message:S}=R("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async i=>{if(!Me(i)){const{message:w}=R("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(w)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),d=Kn(o,"update()");if(d)throw new Error(d.message);const y=Eu(h.requiredNamespaces,o,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async i=>{if(!Me(i)){const{message:o}=R("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!Me(i)){const{message:w}=R("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(w)}const{topic:n,request:o,chainId:h,expiry:d}=i;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!bu(y,h)){const{message:w}=R("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(w)}if(!n0(o)){const{message:w}=R("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(w)}if(!c0(y,h,o.method)){const{message:w}=R("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(w)}if(d&&!p0(d,Jn)){const{message:w}=R("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Jn.min} and ${Jn.max}`);throw new Error(w)}},this.isValidRespond=async i=>{var n;if(!Me(i)){const{message:d}=R("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(d)}const{topic:o,response:h}=i;try{await this.isValidSessionTopic(o)}catch(d){throw(n=i==null?void 0:i.response)!=null&&n.id&&this.cleanupAfterResponse(i),d}if(!o0(h)){const{message:d}=R("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(d)}},this.isValidPing=async i=>{if(!Me(i)){const{message:o}=R("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!Me(i)){const{message:y}=R("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(y)}const{topic:n,event:o,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!bu(d,h)){const{message:y}=R("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(y)}if(!a0(o)){const{message:y}=R("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}if(!u0(d,h,o.name)){const{message:y}=R("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}},this.isValidDisconnect=async i=>{if(!Me(i)){const{message:o}=R("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||Ci,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!_e(o,!1)){const{message:h}=R("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:r}=R("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Re.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);try{go(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(it.expired,async r=>{const{topic:i,id:n}=yh(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,R("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession({topic:i,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(or.create,r=>this.onPairingCreated(r))}isValidPairingTopic(r){if(!_e(r,!1)){const{message:i}=R("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=R("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(Bt(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=R("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!_e(r,!1)){const{message:i}=R("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=R("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(Bt(this.client.session.get(r).expiry)){await this.deleteSession({topic:r});const{message:i}=R("EXPIRED",`session topic: ${r}`);throw new Error(i)}if(!this.client.core.crypto.keychain.has(r)){const{message:i}=R("MISSING_OR_INVALID",`session topic does not exist in keychain: ${r}`);throw await this.deleteSession({topic:r}),new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(_e(r,!1)){const{message:i}=R("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=R("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!r0(r)){const{message:i}=R("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=R("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(Bt(this.client.proposal.get(r).expiryTimestamp)){await this.deleteProposal(r);const{message:i}=R("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class m1 extends ws{constructor(r,i){super(r,i,a1,So),this.core=r,this.logger=i}}let w1=class extends ws{constructor(r,i){super(r,i,c1,So),this.core=r,this.logger=i}};class _1 extends ws{constructor(r,i){super(r,i,h1,So,n=>n.id),this.core=r,this.logger=i}}let b1=class Uh extends N0{constructor(r){super(r),this.protocol=Ah,this.version=Dh,this.name=Qn.name,this.events=new Tt.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||Qn.name,this.metadata=(r==null?void 0:r.metadata)||mw();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:G.pino(G.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Qn.logger}));this.core=(r==null?void 0:r.core)||new o1(r),this.logger=G.generateChildLogger(i,this.name),this.session=new w1(this.core,this.logger),this.proposal=new m1(this.core,this.logger),this.pendingRequest=new _1(this.core,this.logger),this.engine=new v1(this)}static async init(r){const i=new Uh(r);return await i.initialize(),i}get context(){return G.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};const Gu="error",E1="wss://relay.walletconnect.com",I1="wc",P1="universal_provider",Bu=`${I1}@2:${P1}:`,S1="https://rpc.walletconnect.com/v1/",Dt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var sr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof le<"u"?le:typeof self<"u"?self:{},uo={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var i,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",y="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",S=500,N="__lodash_placeholder__",O=1,T=2,J=4,U=1,Z=2,se=1,ee=2,Oe=4,ne=8,te=16,B=32,me=64,pe=128,Ce=256,qt=512,kh=30,zh="...",Vh=800,Hh=16,Co=1,Kh=2,Fh=3,Yt=1/0,jt=9007199254740991,Gh=17976931348623157e292,gr=NaN,pt=4294967295,Bh=pt-1,Wh=pt>>>1,Qh=[["ary",pe],["bind",se],["bindKey",ee],["curry",ne],["curryRight",te],["flip",qt],["partial",B],["partialRight",me],["rearg",Ce]],hi="[object Arguments]",yr="[object Array]",Jh="[object AsyncFunction]",Di="[object Boolean]",qi="[object Date]",Yh="[object DOMException]",vr="[object Error]",mr="[object Function]",No="[object GeneratorFunction]",st="[object Map]",ji="[object Number]",Zh="[object Null]",mt="[object Object]",xo="[object Promise]",Xh="[object Proxy]",Ui="[object RegExp]",nt="[object Set]",Li="[object String]",wr="[object Symbol]",el="[object Undefined]",Mi="[object WeakMap]",tl="[object WeakSet]",ki="[object ArrayBuffer]",li="[object DataView]",_s="[object Float32Array]",bs="[object Float64Array]",Es="[object Int8Array]",Is="[object Int16Array]",Ps="[object Int32Array]",Ss="[object Uint8Array]",Rs="[object Uint8ClampedArray]",Os="[object Uint16Array]",Cs="[object Uint32Array]",il=/\b__p \+= '';/g,rl=/\b(__p \+=) '' \+/g,sl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$o=/&(?:amp|lt|gt|quot|#39);/g,To=/[&<>"']/g,nl=RegExp($o.source),ol=RegExp(To.source),al=/<%-([\s\S]+?)%>/g,cl=/<%([\s\S]+?)%>/g,Ao=/<%=([\s\S]+?)%>/g,ul=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hl=/^\w*$/,ll=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ns=/[\\^$.*+?()[\]{}|]/g,pl=RegExp(Ns.source),xs=/^\s+/,dl=/\s/,fl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,gl=/\{\n\/\* \[wrapped with (.+)\] \*/,yl=/,? & /,vl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ml=/[()=,{}\[\]\/\s]/,wl=/\\(\\)?/g,_l=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Do=/\w*$/,bl=/^[-+]0x[0-9a-f]+$/i,El=/^0b[01]+$/i,Il=/^\[object .+?Constructor\]$/,Pl=/^0o[0-7]+$/i,Sl=/^(?:0|[1-9]\d*)$/,Rl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_r=/($^)/,Ol=/['\n\r\u2028\u2029\\]/g,br="\\ud800-\\udfff",Cl="\\u0300-\\u036f",Nl="\\ufe20-\\ufe2f",xl="\\u20d0-\\u20ff",qo=Cl+Nl+xl,jo="\\u2700-\\u27bf",Uo="a-z\\xdf-\\xf6\\xf8-\\xff",$l="\\xac\\xb1\\xd7\\xf7",Tl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Al="\\u2000-\\u206f",Dl=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Lo="A-Z\\xc0-\\xd6\\xd8-\\xde",Mo="\\ufe0e\\ufe0f",ko=$l+Tl+Al+Dl,$s="['’]",ql="["+br+"]",zo="["+ko+"]",Er="["+qo+"]",Vo="\\d+",jl="["+jo+"]",Ho="["+Uo+"]",Ko="[^"+br+ko+Vo+jo+Uo+Lo+"]",Ts="\\ud83c[\\udffb-\\udfff]",Ul="(?:"+Er+"|"+Ts+")",Fo="[^"+br+"]",As="(?:\\ud83c[\\udde6-\\uddff]){2}",Ds="[\\ud800-\\udbff][\\udc00-\\udfff]",pi="["+Lo+"]",Go="\\u200d",Bo="(?:"+Ho+"|"+Ko+")",Ll="(?:"+pi+"|"+Ko+")",Wo="(?:"+$s+"(?:d|ll|m|re|s|t|ve))?",Qo="(?:"+$s+"(?:D|LL|M|RE|S|T|VE))?",Jo=Ul+"?",Yo="["+Mo+"]?",Ml="(?:"+Go+"(?:"+[Fo,As,Ds].join("|")+")"+Yo+Jo+")*",kl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",zl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zo=Yo+Jo+Ml,Vl="(?:"+[jl,As,Ds].join("|")+")"+Zo,Hl="(?:"+[Fo+Er+"?",Er,As,Ds,ql].join("|")+")",Kl=RegExp($s,"g"),Fl=RegExp(Er,"g"),qs=RegExp(Ts+"(?="+Ts+")|"+Hl+Zo,"g"),Gl=RegExp([pi+"?"+Ho+"+"+Wo+"(?="+[zo,pi,"$"].join("|")+")",Ll+"+"+Qo+"(?="+[zo,pi+Bo,"$"].join("|")+")",pi+"?"+Bo+"+"+Wo,pi+"+"+Qo,zl,kl,Vo,Vl].join("|"),"g"),Bl=RegExp("["+Go+br+qo+Mo+"]"),Wl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ql=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jl=-1,re={};re[_s]=re[bs]=re[Es]=re[Is]=re[Ps]=re[Ss]=re[Rs]=re[Os]=re[Cs]=!0,re[hi]=re[yr]=re[ki]=re[Di]=re[li]=re[qi]=re[vr]=re[mr]=re[st]=re[ji]=re[mt]=re[Ui]=re[nt]=re[Li]=re[Mi]=!1;var ie={};ie[hi]=ie[yr]=ie[ki]=ie[li]=ie[Di]=ie[qi]=ie[_s]=ie[bs]=ie[Es]=ie[Is]=ie[Ps]=ie[st]=ie[ji]=ie[mt]=ie[Ui]=ie[nt]=ie[Li]=ie[wr]=ie[Ss]=ie[Rs]=ie[Os]=ie[Cs]=!0,ie[vr]=ie[mr]=ie[Mi]=!1;var Yl={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Zl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ep={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tp=parseFloat,ip=parseInt,Xo=typeof sr=="object"&&sr&&sr.Object===Object&&sr,rp=typeof self=="object"&&self&&self.Object===Object&&self,be=Xo||rp||Function("return this")(),js=r&&!r.nodeType&&r,Zt=js&&!0&&a&&!a.nodeType&&a,ea=Zt&&Zt.exports===js,Us=ea&&Xo.process,We=function(){try{var v=Zt&&Zt.require&&Zt.require("util").types;return v||Us&&Us.binding&&Us.binding("util")}catch{}}(),ta=We&&We.isArrayBuffer,ia=We&&We.isDate,ra=We&&We.isMap,sa=We&&We.isRegExp,na=We&&We.isSet,oa=We&&We.isTypedArray;function ke(v,b,_){switch(_.length){case 0:return v.call(b);case 1:return v.call(b,_[0]);case 2:return v.call(b,_[0],_[1]);case 3:return v.call(b,_[0],_[1],_[2])}return v.apply(b,_)}function sp(v,b,_,x){for(var L=-1,W=v==null?0:v.length;++L<W;){var ye=v[L];b(x,ye,_(ye),v)}return x}function Qe(v,b){for(var _=-1,x=v==null?0:v.length;++_<x&&b(v[_],_,v)!==!1;);return v}function np(v,b){for(var _=v==null?0:v.length;_--&&b(v[_],_,v)!==!1;);return v}function aa(v,b){for(var _=-1,x=v==null?0:v.length;++_<x;)if(!b(v[_],_,v))return!1;return!0}function Ut(v,b){for(var _=-1,x=v==null?0:v.length,L=0,W=[];++_<x;){var ye=v[_];b(ye,_,v)&&(W[L++]=ye)}return W}function Ir(v,b){var _=v==null?0:v.length;return!!_&&di(v,b,0)>-1}function Ls(v,b,_){for(var x=-1,L=v==null?0:v.length;++x<L;)if(_(b,v[x]))return!0;return!1}function oe(v,b){for(var _=-1,x=v==null?0:v.length,L=Array(x);++_<x;)L[_]=b(v[_],_,v);return L}function Lt(v,b){for(var _=-1,x=b.length,L=v.length;++_<x;)v[L+_]=b[_];return v}function Ms(v,b,_,x){var L=-1,W=v==null?0:v.length;for(x&&W&&(_=v[++L]);++L<W;)_=b(_,v[L],L,v);return _}function op(v,b,_,x){var L=v==null?0:v.length;for(x&&L&&(_=v[--L]);L--;)_=b(_,v[L],L,v);return _}function ks(v,b){for(var _=-1,x=v==null?0:v.length;++_<x;)if(b(v[_],_,v))return!0;return!1}var ap=zs("length");function cp(v){return v.split("")}function up(v){return v.match(vl)||[]}function ca(v,b,_){var x;return _(v,function(L,W,ye){if(b(L,W,ye))return x=W,!1}),x}function Pr(v,b,_,x){for(var L=v.length,W=_+(x?1:-1);x?W--:++W<L;)if(b(v[W],W,v))return W;return-1}function di(v,b,_){return b===b?bp(v,b,_):Pr(v,ua,_)}function hp(v,b,_,x){for(var L=_-1,W=v.length;++L<W;)if(x(v[L],b))return L;return-1}function ua(v){return v!==v}function ha(v,b){var _=v==null?0:v.length;return _?Hs(v,b)/_:gr}function zs(v){return function(b){return b==null?i:b[v]}}function Vs(v){return function(b){return v==null?i:v[b]}}function la(v,b,_,x,L){return L(v,function(W,ye,X){_=x?(x=!1,W):b(_,W,ye,X)}),_}function lp(v,b){var _=v.length;for(v.sort(b);_--;)v[_]=v[_].value;return v}function Hs(v,b){for(var _,x=-1,L=v.length;++x<L;){var W=b(v[x]);W!==i&&(_=_===i?W:_+W)}return _}function Ks(v,b){for(var _=-1,x=Array(v);++_<v;)x[_]=b(_);return x}function pp(v,b){return oe(b,function(_){return[_,v[_]]})}function pa(v){return v&&v.slice(0,ya(v)+1).replace(xs,"")}function ze(v){return function(b){return v(b)}}function Fs(v,b){return oe(b,function(_){return v[_]})}function zi(v,b){return v.has(b)}function da(v,b){for(var _=-1,x=v.length;++_<x&&di(b,v[_],0)>-1;);return _}function fa(v,b){for(var _=v.length;_--&&di(b,v[_],0)>-1;);return _}function dp(v,b){for(var _=v.length,x=0;_--;)v[_]===b&&++x;return x}var fp=Vs(Yl),gp=Vs(Zl);function yp(v){return"\\"+ep[v]}function vp(v,b){return v==null?i:v[b]}function fi(v){return Bl.test(v)}function mp(v){return Wl.test(v)}function wp(v){for(var b,_=[];!(b=v.next()).done;)_.push(b.value);return _}function Gs(v){var b=-1,_=Array(v.size);return v.forEach(function(x,L){_[++b]=[L,x]}),_}function ga(v,b){return function(_){return v(b(_))}}function Mt(v,b){for(var _=-1,x=v.length,L=0,W=[];++_<x;){var ye=v[_];(ye===b||ye===N)&&(v[_]=N,W[L++]=_)}return W}function Sr(v){var b=-1,_=Array(v.size);return v.forEach(function(x){_[++b]=x}),_}function _p(v){var b=-1,_=Array(v.size);return v.forEach(function(x){_[++b]=[x,x]}),_}function bp(v,b,_){for(var x=_-1,L=v.length;++x<L;)if(v[x]===b)return x;return-1}function Ep(v,b,_){for(var x=_+1;x--;)if(v[x]===b)return x;return x}function gi(v){return fi(v)?Pp(v):ap(v)}function ot(v){return fi(v)?Sp(v):cp(v)}function ya(v){for(var b=v.length;b--&&dl.test(v.charAt(b)););return b}var Ip=Vs(Xl);function Pp(v){for(var b=qs.lastIndex=0;qs.test(v);)++b;return b}function Sp(v){return v.match(qs)||[]}function Rp(v){return v.match(Gl)||[]}var Op=function v(b){b=b==null?be:yi.defaults(be.Object(),b,yi.pick(be,Ql));var _=b.Array,x=b.Date,L=b.Error,W=b.Function,ye=b.Math,X=b.Object,Bs=b.RegExp,Cp=b.String,Je=b.TypeError,Rr=_.prototype,Np=W.prototype,vi=X.prototype,Or=b["__core-js_shared__"],Cr=Np.toString,Y=vi.hasOwnProperty,xp=0,va=function(){var e=/[^.]+$/.exec(Or&&Or.keys&&Or.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Nr=vi.toString,$p=Cr.call(X),Tp=be._,Ap=Bs("^"+Cr.call(Y).replace(Ns,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xr=ea?b.Buffer:i,kt=b.Symbol,$r=b.Uint8Array,ma=xr?xr.allocUnsafe:i,Tr=ga(X.getPrototypeOf,X),wa=X.create,_a=vi.propertyIsEnumerable,Ar=Rr.splice,ba=kt?kt.isConcatSpreadable:i,Vi=kt?kt.iterator:i,Xt=kt?kt.toStringTag:i,Dr=function(){try{var e=si(X,"defineProperty");return e({},"",{}),e}catch{}}(),Dp=b.clearTimeout!==be.clearTimeout&&b.clearTimeout,qp=x&&x.now!==be.Date.now&&x.now,jp=b.setTimeout!==be.setTimeout&&b.setTimeout,qr=ye.ceil,jr=ye.floor,Ws=X.getOwnPropertySymbols,Up=xr?xr.isBuffer:i,Ea=b.isFinite,Lp=Rr.join,Mp=ga(X.keys,X),ve=ye.max,Pe=ye.min,kp=x.now,zp=b.parseInt,Ia=ye.random,Vp=Rr.reverse,Qs=si(b,"DataView"),Hi=si(b,"Map"),Js=si(b,"Promise"),mi=si(b,"Set"),Ki=si(b,"WeakMap"),Fi=si(X,"create"),Ur=Ki&&new Ki,wi={},Hp=ni(Qs),Kp=ni(Hi),Fp=ni(Js),Gp=ni(mi),Bp=ni(Ki),Lr=kt?kt.prototype:i,Gi=Lr?Lr.valueOf:i,Pa=Lr?Lr.toString:i;function l(e){if(he(e)&&!M(e)&&!(e instanceof K)){if(e instanceof Ye)return e;if(Y.call(e,"__wrapped__"))return Sc(e)}return new Ye(e)}var _i=function(){function e(){}return function(t){if(!ue(t))return{};if(wa)return wa(t);e.prototype=t;var s=new e;return e.prototype=i,s}}();function Mr(){}function Ye(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}l.templateSettings={escape:al,evaluate:cl,interpolate:Ao,variable:"",imports:{_:l}},l.prototype=Mr.prototype,l.prototype.constructor=l,Ye.prototype=_i(Mr.prototype),Ye.prototype.constructor=Ye;function K(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pt,this.__views__=[]}function Wp(){var e=new K(this.__wrapped__);return e.__actions__=qe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=qe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=qe(this.__views__),e}function Qp(){if(this.__filtered__){var e=new K(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Jp(){var e=this.__wrapped__.value(),t=this.__dir__,s=M(e),c=t<0,u=s?e.length:0,p=uf(0,u,this.__views__),f=p.start,g=p.end,m=g-f,E=c?g:f-1,I=this.__iteratees__,P=I.length,C=0,$=Pe(m,this.__takeCount__);if(!s||!c&&u==m&&$==m)return Wa(e,this.__actions__);var q=[];e:for(;m--&&C<$;){E+=t;for(var z=-1,j=e[E];++z<P;){var H=I[z],F=H.iteratee,Ke=H.type,$e=F(j);if(Ke==Kh)j=$e;else if(!$e){if(Ke==Co)continue e;break e}}q[C++]=j}return q}K.prototype=_i(Mr.prototype),K.prototype.constructor=K;function ei(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Yp(){this.__data__=Fi?Fi(null):{},this.size=0}function Zp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Xp(e){var t=this.__data__;if(Fi){var s=t[e];return s===w?i:s}return Y.call(t,e)?t[e]:i}function ed(e){var t=this.__data__;return Fi?t[e]!==i:Y.call(t,e)}function td(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Fi&&t===i?w:t,this}ei.prototype.clear=Yp,ei.prototype.delete=Zp,ei.prototype.get=Xp,ei.prototype.has=ed,ei.prototype.set=td;function wt(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function id(){this.__data__=[],this.size=0}function rd(e){var t=this.__data__,s=kr(t,e);if(s<0)return!1;var c=t.length-1;return s==c?t.pop():Ar.call(t,s,1),--this.size,!0}function sd(e){var t=this.__data__,s=kr(t,e);return s<0?i:t[s][1]}function nd(e){return kr(this.__data__,e)>-1}function od(e,t){var s=this.__data__,c=kr(s,e);return c<0?(++this.size,s.push([e,t])):s[c][1]=t,this}wt.prototype.clear=id,wt.prototype.delete=rd,wt.prototype.get=sd,wt.prototype.has=nd,wt.prototype.set=od;function _t(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function ad(){this.size=0,this.__data__={hash:new ei,map:new(Hi||wt),string:new ei}}function cd(e){var t=Zr(this,e).delete(e);return this.size-=t?1:0,t}function ud(e){return Zr(this,e).get(e)}function hd(e){return Zr(this,e).has(e)}function ld(e,t){var s=Zr(this,e),c=s.size;return s.set(e,t),this.size+=s.size==c?0:1,this}_t.prototype.clear=ad,_t.prototype.delete=cd,_t.prototype.get=ud,_t.prototype.has=hd,_t.prototype.set=ld;function ti(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new _t;++t<s;)this.add(e[t])}function pd(e){return this.__data__.set(e,w),this}function dd(e){return this.__data__.has(e)}ti.prototype.add=ti.prototype.push=pd,ti.prototype.has=dd;function at(e){var t=this.__data__=new wt(e);this.size=t.size}function fd(){this.__data__=new wt,this.size=0}function gd(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function yd(e){return this.__data__.get(e)}function vd(e){return this.__data__.has(e)}function md(e,t){var s=this.__data__;if(s instanceof wt){var c=s.__data__;if(!Hi||c.length<o-1)return c.push([e,t]),this.size=++s.size,this;s=this.__data__=new _t(c)}return s.set(e,t),this.size=s.size,this}at.prototype.clear=fd,at.prototype.delete=gd,at.prototype.get=yd,at.prototype.has=vd,at.prototype.set=md;function Sa(e,t){var s=M(e),c=!s&&oi(e),u=!s&&!c&&Ft(e),p=!s&&!c&&!u&&Pi(e),f=s||c||u||p,g=f?Ks(e.length,Cp):[],m=g.length;for(var E in e)(t||Y.call(e,E))&&!(f&&(E=="length"||u&&(E=="offset"||E=="parent")||p&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||Pt(E,m)))&&g.push(E);return g}function Ra(e){var t=e.length;return t?e[cn(0,t-1)]:i}function wd(e,t){return Xr(qe(e),ii(t,0,e.length))}function _d(e){return Xr(qe(e))}function Ys(e,t,s){(s!==i&&!ct(e[t],s)||s===i&&!(t in e))&&bt(e,t,s)}function Bi(e,t,s){var c=e[t];(!(Y.call(e,t)&&ct(c,s))||s===i&&!(t in e))&&bt(e,t,s)}function kr(e,t){for(var s=e.length;s--;)if(ct(e[s][0],t))return s;return-1}function bd(e,t,s,c){return zt(e,function(u,p,f){t(c,u,s(u),f)}),c}function Oa(e,t){return e&&ft(t,we(t),e)}function Ed(e,t){return e&&ft(t,Ue(t),e)}function bt(e,t,s){t=="__proto__"&&Dr?Dr(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function Zs(e,t){for(var s=-1,c=t.length,u=_(c),p=e==null;++s<c;)u[s]=p?i:An(e,t[s]);return u}function ii(e,t,s){return e===e&&(s!==i&&(e=e<=s?e:s),t!==i&&(e=e>=t?e:t)),e}function Ze(e,t,s,c,u,p){var f,g=t&O,m=t&T,E=t&J;if(s&&(f=u?s(e,c,u,p):s(e)),f!==i)return f;if(!ue(e))return e;var I=M(e);if(I){if(f=lf(e),!g)return qe(e,f)}else{var P=Se(e),C=P==mr||P==No;if(Ft(e))return Ya(e,g);if(P==mt||P==hi||C&&!u){if(f=m||C?{}:yc(e),!g)return m?Xd(e,Ed(f,e)):Zd(e,Oa(f,e))}else{if(!ie[P])return u?e:{};f=pf(e,P,g)}}p||(p=new at);var $=p.get(e);if($)return $;p.set(e,f),Fc(e)?e.forEach(function(j){f.add(Ze(j,t,s,j,e,p))}):Hc(e)&&e.forEach(function(j,H){f.set(H,Ze(j,t,s,H,e,p))});var q=E?m?wn:mn:m?Ue:we,z=I?i:q(e);return Qe(z||e,function(j,H){z&&(H=j,j=e[H]),Bi(f,H,Ze(j,t,s,H,e,p))}),f}function Id(e){var t=we(e);return function(s){return Ca(s,e,t)}}function Ca(e,t,s){var c=s.length;if(e==null)return!c;for(e=X(e);c--;){var u=s[c],p=t[u],f=e[u];if(f===i&&!(u in e)||!p(f))return!1}return!0}function Na(e,t,s){if(typeof e!="function")throw new Je(d);return er(function(){e.apply(i,s)},t)}function Wi(e,t,s,c){var u=-1,p=Ir,f=!0,g=e.length,m=[],E=t.length;if(!g)return m;s&&(t=oe(t,ze(s))),c?(p=Ls,f=!1):t.length>=o&&(p=zi,f=!1,t=new ti(t));e:for(;++u<g;){var I=e[u],P=s==null?I:s(I);if(I=c||I!==0?I:0,f&&P===P){for(var C=E;C--;)if(t[C]===P)continue e;m.push(I)}else p(t,P,c)||m.push(I)}return m}var zt=ic(dt),xa=ic(en,!0);function Pd(e,t){var s=!0;return zt(e,function(c,u,p){return s=!!t(c,u,p),s}),s}function zr(e,t,s){for(var c=-1,u=e.length;++c<u;){var p=e[c],f=t(p);if(f!=null&&(g===i?f===f&&!He(f):s(f,g)))var g=f,m=p}return m}function Sd(e,t,s,c){var u=e.length;for(s=k(s),s<0&&(s=-s>u?0:u+s),c=c===i||c>u?u:k(c),c<0&&(c+=u),c=s>c?0:Bc(c);s<c;)e[s++]=t;return e}function $a(e,t){var s=[];return zt(e,function(c,u,p){t(c,u,p)&&s.push(c)}),s}function Ee(e,t,s,c,u){var p=-1,f=e.length;for(s||(s=ff),u||(u=[]);++p<f;){var g=e[p];t>0&&s(g)?t>1?Ee(g,t-1,s,c,u):Lt(u,g):c||(u[u.length]=g)}return u}var Xs=rc(),Ta=rc(!0);function dt(e,t){return e&&Xs(e,t,we)}function en(e,t){return e&&Ta(e,t,we)}function Vr(e,t){return Ut(t,function(s){return St(e[s])})}function ri(e,t){t=Ht(t,e);for(var s=0,c=t.length;e!=null&&s<c;)e=e[gt(t[s++])];return s&&s==c?e:i}function Aa(e,t,s){var c=t(e);return M(e)?c:Lt(c,s(e))}function Ne(e){return e==null?e===i?el:Zh:Xt&&Xt in X(e)?cf(e):bf(e)}function tn(e,t){return e>t}function Rd(e,t){return e!=null&&Y.call(e,t)}function Od(e,t){return e!=null&&t in X(e)}function Cd(e,t,s){return e>=Pe(t,s)&&e<ve(t,s)}function rn(e,t,s){for(var c=s?Ls:Ir,u=e[0].length,p=e.length,f=p,g=_(p),m=1/0,E=[];f--;){var I=e[f];f&&t&&(I=oe(I,ze(t))),m=Pe(I.length,m),g[f]=!s&&(t||u>=120&&I.length>=120)?new ti(f&&I):i}I=e[0];var P=-1,C=g[0];e:for(;++P<u&&E.length<m;){var $=I[P],q=t?t($):$;if($=s||$!==0?$:0,!(C?zi(C,q):c(E,q,s))){for(f=p;--f;){var z=g[f];if(!(z?zi(z,q):c(e[f],q,s)))continue e}C&&C.push(q),E.push($)}}return E}function Nd(e,t,s,c){return dt(e,function(u,p,f){t(c,s(u),p,f)}),c}function Qi(e,t,s){t=Ht(t,e),e=_c(e,t);var c=e==null?e:e[gt(et(t))];return c==null?i:ke(c,e,s)}function Da(e){return he(e)&&Ne(e)==hi}function xd(e){return he(e)&&Ne(e)==ki}function $d(e){return he(e)&&Ne(e)==qi}function Ji(e,t,s,c,u){return e===t?!0:e==null||t==null||!he(e)&&!he(t)?e!==e&&t!==t:Td(e,t,s,c,Ji,u)}function Td(e,t,s,c,u,p){var f=M(e),g=M(t),m=f?yr:Se(e),E=g?yr:Se(t);m=m==hi?mt:m,E=E==hi?mt:E;var I=m==mt,P=E==mt,C=m==E;if(C&&Ft(e)){if(!Ft(t))return!1;f=!0,I=!1}if(C&&!I)return p||(p=new at),f||Pi(e)?dc(e,t,s,c,u,p):of(e,t,m,s,c,u,p);if(!(s&U)){var $=I&&Y.call(e,"__wrapped__"),q=P&&Y.call(t,"__wrapped__");if($||q){var z=$?e.value():e,j=q?t.value():t;return p||(p=new at),u(z,j,s,c,p)}}return C?(p||(p=new at),af(e,t,s,c,u,p)):!1}function Ad(e){return he(e)&&Se(e)==st}function sn(e,t,s,c){var u=s.length,p=u,f=!c;if(e==null)return!p;for(e=X(e);u--;){var g=s[u];if(f&&g[2]?g[1]!==e[g[0]]:!(g[0]in e))return!1}for(;++u<p;){g=s[u];var m=g[0],E=e[m],I=g[1];if(f&&g[2]){if(E===i&&!(m in e))return!1}else{var P=new at;if(c)var C=c(E,I,m,e,t,P);if(!(C===i?Ji(I,E,U|Z,c,P):C))return!1}}return!0}function qa(e){if(!ue(e)||yf(e))return!1;var t=St(e)?Ap:Il;return t.test(ni(e))}function Dd(e){return he(e)&&Ne(e)==Ui}function qd(e){return he(e)&&Se(e)==nt}function jd(e){return he(e)&&ns(e.length)&&!!re[Ne(e)]}function ja(e){return typeof e=="function"?e:e==null?Le:typeof e=="object"?M(e)?Ma(e[0],e[1]):La(e):su(e)}function nn(e){if(!Xi(e))return Mp(e);var t=[];for(var s in X(e))Y.call(e,s)&&s!="constructor"&&t.push(s);return t}function Ud(e){if(!ue(e))return _f(e);var t=Xi(e),s=[];for(var c in e)c=="constructor"&&(t||!Y.call(e,c))||s.push(c);return s}function on(e,t){return e<t}function Ua(e,t){var s=-1,c=je(e)?_(e.length):[];return zt(e,function(u,p,f){c[++s]=t(u,p,f)}),c}function La(e){var t=bn(e);return t.length==1&&t[0][2]?mc(t[0][0],t[0][1]):function(s){return s===e||sn(s,e,t)}}function Ma(e,t){return In(e)&&vc(t)?mc(gt(e),t):function(s){var c=An(s,e);return c===i&&c===t?Dn(s,e):Ji(t,c,U|Z)}}function Hr(e,t,s,c,u){e!==t&&Xs(t,function(p,f){if(u||(u=new at),ue(p))Ld(e,t,f,s,Hr,c,u);else{var g=c?c(Sn(e,f),p,f+"",e,t,u):i;g===i&&(g=p),Ys(e,f,g)}},Ue)}function Ld(e,t,s,c,u,p,f){var g=Sn(e,s),m=Sn(t,s),E=f.get(m);if(E){Ys(e,s,E);return}var I=p?p(g,m,s+"",e,t,f):i,P=I===i;if(P){var C=M(m),$=!C&&Ft(m),q=!C&&!$&&Pi(m);I=m,C||$||q?M(g)?I=g:de(g)?I=qe(g):$?(P=!1,I=Ya(m,!0)):q?(P=!1,I=Za(m,!0)):I=[]:tr(m)||oi(m)?(I=g,oi(g)?I=Wc(g):(!ue(g)||St(g))&&(I=yc(m))):P=!1}P&&(f.set(m,I),u(I,m,c,p,f),f.delete(m)),Ys(e,s,I)}function ka(e,t){var s=e.length;if(s)return t+=t<0?s:0,Pt(t,s)?e[t]:i}function za(e,t,s){t.length?t=oe(t,function(p){return M(p)?function(f){return ri(f,p.length===1?p[0]:p)}:p}):t=[Le];var c=-1;t=oe(t,ze(D()));var u=Ua(e,function(p,f,g){var m=oe(t,function(E){return E(p)});return{criteria:m,index:++c,value:p}});return lp(u,function(p,f){return Yd(p,f,s)})}function Md(e,t){return Va(e,t,function(s,c){return Dn(e,c)})}function Va(e,t,s){for(var c=-1,u=t.length,p={};++c<u;){var f=t[c],g=ri(e,f);s(g,f)&&Yi(p,Ht(f,e),g)}return p}function kd(e){return function(t){return ri(t,e)}}function an(e,t,s,c){var u=c?hp:di,p=-1,f=t.length,g=e;for(e===t&&(t=qe(t)),s&&(g=oe(e,ze(s)));++p<f;)for(var m=0,E=t[p],I=s?s(E):E;(m=u(g,I,m,c))>-1;)g!==e&&Ar.call(g,m,1),Ar.call(e,m,1);return e}function Ha(e,t){for(var s=e?t.length:0,c=s-1;s--;){var u=t[s];if(s==c||u!==p){var p=u;Pt(u)?Ar.call(e,u,1):ln(e,u)}}return e}function cn(e,t){return e+jr(Ia()*(t-e+1))}function zd(e,t,s,c){for(var u=-1,p=ve(qr((t-e)/(s||1)),0),f=_(p);p--;)f[c?p:++u]=e,e+=s;return f}function un(e,t){var s="";if(!e||t<1||t>jt)return s;do t%2&&(s+=e),t=jr(t/2),t&&(e+=e);while(t);return s}function V(e,t){return Rn(wc(e,t,Le),e+"")}function Vd(e){return Ra(Si(e))}function Hd(e,t){var s=Si(e);return Xr(s,ii(t,0,s.length))}function Yi(e,t,s,c){if(!ue(e))return e;t=Ht(t,e);for(var u=-1,p=t.length,f=p-1,g=e;g!=null&&++u<p;){var m=gt(t[u]),E=s;if(m==="__proto__"||m==="constructor"||m==="prototype")return e;if(u!=f){var I=g[m];E=c?c(I,m,g):i,E===i&&(E=ue(I)?I:Pt(t[u+1])?[]:{})}Bi(g,m,E),g=g[m]}return e}var Ka=Ur?function(e,t){return Ur.set(e,t),e}:Le,Kd=Dr?function(e,t){return Dr(e,"toString",{configurable:!0,enumerable:!1,value:jn(t),writable:!0})}:Le;function Fd(e){return Xr(Si(e))}function Xe(e,t,s){var c=-1,u=e.length;t<0&&(t=-t>u?0:u+t),s=s>u?u:s,s<0&&(s+=u),u=t>s?0:s-t>>>0,t>>>=0;for(var p=_(u);++c<u;)p[c]=e[c+t];return p}function Gd(e,t){var s;return zt(e,function(c,u,p){return s=t(c,u,p),!s}),!!s}function Kr(e,t,s){var c=0,u=e==null?c:e.length;if(typeof t=="number"&&t===t&&u<=Wh){for(;c<u;){var p=c+u>>>1,f=e[p];f!==null&&!He(f)&&(s?f<=t:f<t)?c=p+1:u=p}return u}return hn(e,t,Le,s)}function hn(e,t,s,c){var u=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var f=t!==t,g=t===null,m=He(t),E=t===i;u<p;){var I=jr((u+p)/2),P=s(e[I]),C=P!==i,$=P===null,q=P===P,z=He(P);if(f)var j=c||q;else E?j=q&&(c||C):g?j=q&&C&&(c||!$):m?j=q&&C&&!$&&(c||!z):$||z?j=!1:j=c?P<=t:P<t;j?u=I+1:p=I}return Pe(p,Bh)}function Fa(e,t){for(var s=-1,c=e.length,u=0,p=[];++s<c;){var f=e[s],g=t?t(f):f;if(!s||!ct(g,m)){var m=g;p[u++]=f===0?0:f}}return p}function Ga(e){return typeof e=="number"?e:He(e)?gr:+e}function Ve(e){if(typeof e=="string")return e;if(M(e))return oe(e,Ve)+"";if(He(e))return Pa?Pa.call(e):"";var t=e+"";return t=="0"&&1/e==-Yt?"-0":t}function Vt(e,t,s){var c=-1,u=Ir,p=e.length,f=!0,g=[],m=g;if(s)f=!1,u=Ls;else if(p>=o){var E=t?null:sf(e);if(E)return Sr(E);f=!1,u=zi,m=new ti}else m=t?[]:g;e:for(;++c<p;){var I=e[c],P=t?t(I):I;if(I=s||I!==0?I:0,f&&P===P){for(var C=m.length;C--;)if(m[C]===P)continue e;t&&m.push(P),g.push(I)}else u(m,P,s)||(m!==g&&m.push(P),g.push(I))}return g}function ln(e,t){return t=Ht(t,e),e=_c(e,t),e==null||delete e[gt(et(t))]}function Ba(e,t,s,c){return Yi(e,t,s(ri(e,t)),c)}function Fr(e,t,s,c){for(var u=e.length,p=c?u:-1;(c?p--:++p<u)&&t(e[p],p,e););return s?Xe(e,c?0:p,c?p+1:u):Xe(e,c?p+1:0,c?u:p)}function Wa(e,t){var s=e;return s instanceof K&&(s=s.value()),Ms(t,function(c,u){return u.func.apply(u.thisArg,Lt([c],u.args))},s)}function pn(e,t,s){var c=e.length;if(c<2)return c?Vt(e[0]):[];for(var u=-1,p=_(c);++u<c;)for(var f=e[u],g=-1;++g<c;)g!=u&&(p[u]=Wi(p[u]||f,e[g],t,s));return Vt(Ee(p,1),t,s)}function Qa(e,t,s){for(var c=-1,u=e.length,p=t.length,f={};++c<u;){var g=c<p?t[c]:i;s(f,e[c],g)}return f}function dn(e){return de(e)?e:[]}function fn(e){return typeof e=="function"?e:Le}function Ht(e,t){return M(e)?e:In(e,t)?[e]:Pc(Q(e))}var Bd=V;function Kt(e,t,s){var c=e.length;return s=s===i?c:s,!t&&s>=c?e:Xe(e,t,s)}var Ja=Dp||function(e){return be.clearTimeout(e)};function Ya(e,t){if(t)return e.slice();var s=e.length,c=ma?ma(s):new e.constructor(s);return e.copy(c),c}function gn(e){var t=new e.constructor(e.byteLength);return new $r(t).set(new $r(e)),t}function Wd(e,t){var s=t?gn(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Qd(e){var t=new e.constructor(e.source,Do.exec(e));return t.lastIndex=e.lastIndex,t}function Jd(e){return Gi?X(Gi.call(e)):{}}function Za(e,t){var s=t?gn(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Xa(e,t){if(e!==t){var s=e!==i,c=e===null,u=e===e,p=He(e),f=t!==i,g=t===null,m=t===t,E=He(t);if(!g&&!E&&!p&&e>t||p&&f&&m&&!g&&!E||c&&f&&m||!s&&m||!u)return 1;if(!c&&!p&&!E&&e<t||E&&s&&u&&!c&&!p||g&&s&&u||!f&&u||!m)return-1}return 0}function Yd(e,t,s){for(var c=-1,u=e.criteria,p=t.criteria,f=u.length,g=s.length;++c<f;){var m=Xa(u[c],p[c]);if(m){if(c>=g)return m;var E=s[c];return m*(E=="desc"?-1:1)}}return e.index-t.index}function ec(e,t,s,c){for(var u=-1,p=e.length,f=s.length,g=-1,m=t.length,E=ve(p-f,0),I=_(m+E),P=!c;++g<m;)I[g]=t[g];for(;++u<f;)(P||u<p)&&(I[s[u]]=e[u]);for(;E--;)I[g++]=e[u++];return I}function tc(e,t,s,c){for(var u=-1,p=e.length,f=-1,g=s.length,m=-1,E=t.length,I=ve(p-g,0),P=_(I+E),C=!c;++u<I;)P[u]=e[u];for(var $=u;++m<E;)P[$+m]=t[m];for(;++f<g;)(C||u<p)&&(P[$+s[f]]=e[u++]);return P}function qe(e,t){var s=-1,c=e.length;for(t||(t=_(c));++s<c;)t[s]=e[s];return t}function ft(e,t,s,c){var u=!s;s||(s={});for(var p=-1,f=t.length;++p<f;){var g=t[p],m=c?c(s[g],e[g],g,s,e):i;m===i&&(m=e[g]),u?bt(s,g,m):Bi(s,g,m)}return s}function Zd(e,t){return ft(e,En(e),t)}function Xd(e,t){return ft(e,fc(e),t)}function Gr(e,t){return function(s,c){var u=M(s)?sp:bd,p=t?t():{};return u(s,e,D(c,2),p)}}function bi(e){return V(function(t,s){var c=-1,u=s.length,p=u>1?s[u-1]:i,f=u>2?s[2]:i;for(p=e.length>3&&typeof p=="function"?(u--,p):i,f&&xe(s[0],s[1],f)&&(p=u<3?i:p,u=1),t=X(t);++c<u;){var g=s[c];g&&e(t,g,c,p)}return t})}function ic(e,t){return function(s,c){if(s==null)return s;if(!je(s))return e(s,c);for(var u=s.length,p=t?u:-1,f=X(s);(t?p--:++p<u)&&c(f[p],p,f)!==!1;);return s}}function rc(e){return function(t,s,c){for(var u=-1,p=X(t),f=c(t),g=f.length;g--;){var m=f[e?g:++u];if(s(p[m],m,p)===!1)break}return t}}function ef(e,t,s){var c=t&se,u=Zi(e);function p(){var f=this&&this!==be&&this instanceof p?u:e;return f.apply(c?s:this,arguments)}return p}function sc(e){return function(t){t=Q(t);var s=fi(t)?ot(t):i,c=s?s[0]:t.charAt(0),u=s?Kt(s,1).join(""):t.slice(1);return c[e]()+u}}function Ei(e){return function(t){return Ms(iu(tu(t).replace(Kl,"")),e,"")}}function Zi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=_i(e.prototype),c=e.apply(s,t);return ue(c)?c:s}}function tf(e,t,s){var c=Zi(e);function u(){for(var p=arguments.length,f=_(p),g=p,m=Ii(u);g--;)f[g]=arguments[g];var E=p<3&&f[0]!==m&&f[p-1]!==m?[]:Mt(f,m);if(p-=E.length,p<s)return uc(e,t,Br,u.placeholder,i,f,E,i,i,s-p);var I=this&&this!==be&&this instanceof u?c:e;return ke(I,this,f)}return u}function nc(e){return function(t,s,c){var u=X(t);if(!je(t)){var p=D(s,3);t=we(t),s=function(g){return p(u[g],g,u)}}var f=e(t,s,c);return f>-1?u[p?t[f]:f]:i}}function oc(e){return It(function(t){var s=t.length,c=s,u=Ye.prototype.thru;for(e&&t.reverse();c--;){var p=t[c];if(typeof p!="function")throw new Je(d);if(u&&!f&&Yr(p)=="wrapper")var f=new Ye([],!0)}for(c=f?c:s;++c<s;){p=t[c];var g=Yr(p),m=g=="wrapper"?_n(p):i;m&&Pn(m[0])&&m[1]==(pe|ne|B|Ce)&&!m[4].length&&m[9]==1?f=f[Yr(m[0])].apply(f,m[3]):f=p.length==1&&Pn(p)?f[g]():f.thru(p)}return function(){var E=arguments,I=E[0];if(f&&E.length==1&&M(I))return f.plant(I).value();for(var P=0,C=s?t[P].apply(this,E):I;++P<s;)C=t[P].call(this,C);return C}})}function Br(e,t,s,c,u,p,f,g,m,E){var I=t&pe,P=t&se,C=t&ee,$=t&(ne|te),q=t&qt,z=C?i:Zi(e);function j(){for(var H=arguments.length,F=_(H),Ke=H;Ke--;)F[Ke]=arguments[Ke];if($)var $e=Ii(j),Fe=dp(F,$e);if(c&&(F=ec(F,c,u,$)),p&&(F=tc(F,p,f,$)),H-=Fe,$&&H<E){var fe=Mt(F,$e);return uc(e,t,Br,j.placeholder,s,F,fe,g,m,E-H)}var ut=P?s:this,Ot=C?ut[e]:e;return H=F.length,g?F=Ef(F,g):q&&H>1&&F.reverse(),I&&m<H&&(F.length=m),this&&this!==be&&this instanceof j&&(Ot=z||Zi(Ot)),Ot.apply(ut,F)}return j}function ac(e,t){return function(s,c){return Nd(s,e,t(c),{})}}function Wr(e,t){return function(s,c){var u;if(s===i&&c===i)return t;if(s!==i&&(u=s),c!==i){if(u===i)return c;typeof s=="string"||typeof c=="string"?(s=Ve(s),c=Ve(c)):(s=Ga(s),c=Ga(c)),u=e(s,c)}return u}}function yn(e){return It(function(t){return t=oe(t,ze(D())),V(function(s){var c=this;return e(t,function(u){return ke(u,c,s)})})})}function Qr(e,t){t=t===i?" ":Ve(t);var s=t.length;if(s<2)return s?un(t,e):t;var c=un(t,qr(e/gi(t)));return fi(t)?Kt(ot(c),0,e).join(""):c.slice(0,e)}function rf(e,t,s,c){var u=t&se,p=Zi(e);function f(){for(var g=-1,m=arguments.length,E=-1,I=c.length,P=_(I+m),C=this&&this!==be&&this instanceof f?p:e;++E<I;)P[E]=c[E];for(;m--;)P[E++]=arguments[++g];return ke(C,u?s:this,P)}return f}function cc(e){return function(t,s,c){return c&&typeof c!="number"&&xe(t,s,c)&&(s=c=i),t=Rt(t),s===i?(s=t,t=0):s=Rt(s),c=c===i?t<s?1:-1:Rt(c),zd(t,s,c,e)}}function Jr(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=tt(t),s=tt(s)),e(t,s)}}function uc(e,t,s,c,u,p,f,g,m,E){var I=t&ne,P=I?f:i,C=I?i:f,$=I?p:i,q=I?i:p;t|=I?B:me,t&=~(I?me:B),t&Oe||(t&=~(se|ee));var z=[e,t,u,$,P,q,C,g,m,E],j=s.apply(i,z);return Pn(e)&&bc(j,z),j.placeholder=c,Ec(j,e,t)}function vn(e){var t=ye[e];return function(s,c){if(s=tt(s),c=c==null?0:Pe(k(c),292),c&&Ea(s)){var u=(Q(s)+"e").split("e"),p=t(u[0]+"e"+(+u[1]+c));return u=(Q(p)+"e").split("e"),+(u[0]+"e"+(+u[1]-c))}return t(s)}}var sf=mi&&1/Sr(new mi([,-0]))[1]==Yt?function(e){return new mi(e)}:Mn;function hc(e){return function(t){var s=Se(t);return s==st?Gs(t):s==nt?_p(t):pp(t,e(t))}}function Et(e,t,s,c,u,p,f,g){var m=t&ee;if(!m&&typeof e!="function")throw new Je(d);var E=c?c.length:0;if(E||(t&=~(B|me),c=u=i),f=f===i?f:ve(k(f),0),g=g===i?g:k(g),E-=u?u.length:0,t&me){var I=c,P=u;c=u=i}var C=m?i:_n(e),$=[e,t,s,c,u,I,P,p,f,g];if(C&&wf($,C),e=$[0],t=$[1],s=$[2],c=$[3],u=$[4],g=$[9]=$[9]===i?m?0:e.length:ve($[9]-E,0),!g&&t&(ne|te)&&(t&=~(ne|te)),!t||t==se)var q=ef(e,t,s);else t==ne||t==te?q=tf(e,t,g):(t==B||t==(se|B))&&!u.length?q=rf(e,t,s,c):q=Br.apply(i,$);var z=C?Ka:bc;return Ec(z(q,$),e,t)}function lc(e,t,s,c){return e===i||ct(e,vi[s])&&!Y.call(c,s)?t:e}function pc(e,t,s,c,u,p){return ue(e)&&ue(t)&&(p.set(t,e),Hr(e,t,i,pc,p),p.delete(t)),e}function nf(e){return tr(e)?i:e}function dc(e,t,s,c,u,p){var f=s&U,g=e.length,m=t.length;if(g!=m&&!(f&&m>g))return!1;var E=p.get(e),I=p.get(t);if(E&&I)return E==t&&I==e;var P=-1,C=!0,$=s&Z?new ti:i;for(p.set(e,t),p.set(t,e);++P<g;){var q=e[P],z=t[P];if(c)var j=f?c(z,q,P,t,e,p):c(q,z,P,e,t,p);if(j!==i){if(j)continue;C=!1;break}if($){if(!ks(t,function(H,F){if(!zi($,F)&&(q===H||u(q,H,s,c,p)))return $.push(F)})){C=!1;break}}else if(!(q===z||u(q,z,s,c,p))){C=!1;break}}return p.delete(e),p.delete(t),C}function of(e,t,s,c,u,p,f){switch(s){case li:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ki:return!(e.byteLength!=t.byteLength||!p(new $r(e),new $r(t)));case Di:case qi:case ji:return ct(+e,+t);case vr:return e.name==t.name&&e.message==t.message;case Ui:case Li:return e==t+"";case st:var g=Gs;case nt:var m=c&U;if(g||(g=Sr),e.size!=t.size&&!m)return!1;var E=f.get(e);if(E)return E==t;c|=Z,f.set(e,t);var I=dc(g(e),g(t),c,u,p,f);return f.delete(e),I;case wr:if(Gi)return Gi.call(e)==Gi.call(t)}return!1}function af(e,t,s,c,u,p){var f=s&U,g=mn(e),m=g.length,E=mn(t),I=E.length;if(m!=I&&!f)return!1;for(var P=m;P--;){var C=g[P];if(!(f?C in t:Y.call(t,C)))return!1}var $=p.get(e),q=p.get(t);if($&&q)return $==t&&q==e;var z=!0;p.set(e,t),p.set(t,e);for(var j=f;++P<m;){C=g[P];var H=e[C],F=t[C];if(c)var Ke=f?c(F,H,C,t,e,p):c(H,F,C,e,t,p);if(!(Ke===i?H===F||u(H,F,s,c,p):Ke)){z=!1;break}j||(j=C=="constructor")}if(z&&!j){var $e=e.constructor,Fe=t.constructor;$e!=Fe&&"constructor"in e&&"constructor"in t&&!(typeof $e=="function"&&$e instanceof $e&&typeof Fe=="function"&&Fe instanceof Fe)&&(z=!1)}return p.delete(e),p.delete(t),z}function It(e){return Rn(wc(e,i,Cc),e+"")}function mn(e){return Aa(e,we,En)}function wn(e){return Aa(e,Ue,fc)}var _n=Ur?function(e){return Ur.get(e)}:Mn;function Yr(e){for(var t=e.name+"",s=wi[t],c=Y.call(wi,t)?s.length:0;c--;){var u=s[c],p=u.func;if(p==null||p==e)return u.name}return t}function Ii(e){var t=Y.call(l,"placeholder")?l:e;return t.placeholder}function D(){var e=l.iteratee||Un;return e=e===Un?ja:e,arguments.length?e(arguments[0],arguments[1]):e}function Zr(e,t){var s=e.__data__;return gf(t)?s[typeof t=="string"?"string":"hash"]:s.map}function bn(e){for(var t=we(e),s=t.length;s--;){var c=t[s],u=e[c];t[s]=[c,u,vc(u)]}return t}function si(e,t){var s=vp(e,t);return qa(s)?s:i}function cf(e){var t=Y.call(e,Xt),s=e[Xt];try{e[Xt]=i;var c=!0}catch{}var u=Nr.call(e);return c&&(t?e[Xt]=s:delete e[Xt]),u}var En=Ws?function(e){return e==null?[]:(e=X(e),Ut(Ws(e),function(t){return _a.call(e,t)}))}:kn,fc=Ws?function(e){for(var t=[];e;)Lt(t,En(e)),e=Tr(e);return t}:kn,Se=Ne;(Qs&&Se(new Qs(new ArrayBuffer(1)))!=li||Hi&&Se(new Hi)!=st||Js&&Se(Js.resolve())!=xo||mi&&Se(new mi)!=nt||Ki&&Se(new Ki)!=Mi)&&(Se=function(e){var t=Ne(e),s=t==mt?e.constructor:i,c=s?ni(s):"";if(c)switch(c){case Hp:return li;case Kp:return st;case Fp:return xo;case Gp:return nt;case Bp:return Mi}return t});function uf(e,t,s){for(var c=-1,u=s.length;++c<u;){var p=s[c],f=p.size;switch(p.type){case"drop":e+=f;break;case"dropRight":t-=f;break;case"take":t=Pe(t,e+f);break;case"takeRight":e=ve(e,t-f);break}}return{start:e,end:t}}function hf(e){var t=e.match(gl);return t?t[1].split(yl):[]}function gc(e,t,s){t=Ht(t,e);for(var c=-1,u=t.length,p=!1;++c<u;){var f=gt(t[c]);if(!(p=e!=null&&s(e,f)))break;e=e[f]}return p||++c!=u?p:(u=e==null?0:e.length,!!u&&ns(u)&&Pt(f,u)&&(M(e)||oi(e)))}function lf(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&Y.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function yc(e){return typeof e.constructor=="function"&&!Xi(e)?_i(Tr(e)):{}}function pf(e,t,s){var c=e.constructor;switch(t){case ki:return gn(e);case Di:case qi:return new c(+e);case li:return Wd(e,s);case _s:case bs:case Es:case Is:case Ps:case Ss:case Rs:case Os:case Cs:return Za(e,s);case st:return new c;case ji:case Li:return new c(e);case Ui:return Qd(e);case nt:return new c;case wr:return Jd(e)}}function df(e,t){var s=t.length;if(!s)return e;var c=s-1;return t[c]=(s>1?"& ":"")+t[c],t=t.join(s>2?", ":" "),e.replace(fl,`{
/* [wrapped with `+t+`] */
`)}function ff(e){return M(e)||oi(e)||!!(ba&&e&&e[ba])}function Pt(e,t){var s=typeof e;return t=t??jt,!!t&&(s=="number"||s!="symbol"&&Sl.test(e))&&e>-1&&e%1==0&&e<t}function xe(e,t,s){if(!ue(s))return!1;var c=typeof t;return(c=="number"?je(s)&&Pt(t,s.length):c=="string"&&t in s)?ct(s[t],e):!1}function In(e,t){if(M(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||He(e)?!0:hl.test(e)||!ul.test(e)||t!=null&&e in X(t)}function gf(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Pn(e){var t=Yr(e),s=l[t];if(typeof s!="function"||!(t in K.prototype))return!1;if(e===s)return!0;var c=_n(s);return!!c&&e===c[0]}function yf(e){return!!va&&va in e}var vf=Or?St:zn;function Xi(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||vi;return e===s}function vc(e){return e===e&&!ue(e)}function mc(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==i||e in X(s))}}function mf(e){var t=rs(e,function(c){return s.size===S&&s.clear(),c}),s=t.cache;return t}function wf(e,t){var s=e[1],c=t[1],u=s|c,p=u<(se|ee|pe),f=c==pe&&s==ne||c==pe&&s==Ce&&e[7].length<=t[8]||c==(pe|Ce)&&t[7].length<=t[8]&&s==ne;if(!(p||f))return e;c&se&&(e[2]=t[2],u|=s&se?0:Oe);var g=t[3];if(g){var m=e[3];e[3]=m?ec(m,g,t[4]):g,e[4]=m?Mt(e[3],N):t[4]}return g=t[5],g&&(m=e[5],e[5]=m?tc(m,g,t[6]):g,e[6]=m?Mt(e[5],N):t[6]),g=t[7],g&&(e[7]=g),c&pe&&(e[8]=e[8]==null?t[8]:Pe(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}function _f(e){var t=[];if(e!=null)for(var s in X(e))t.push(s);return t}function bf(e){return Nr.call(e)}function wc(e,t,s){return t=ve(t===i?e.length-1:t,0),function(){for(var c=arguments,u=-1,p=ve(c.length-t,0),f=_(p);++u<p;)f[u]=c[t+u];u=-1;for(var g=_(t+1);++u<t;)g[u]=c[u];return g[t]=s(f),ke(e,this,g)}}function _c(e,t){return t.length<2?e:ri(e,Xe(t,0,-1))}function Ef(e,t){for(var s=e.length,c=Pe(t.length,s),u=qe(e);c--;){var p=t[c];e[c]=Pt(p,s)?u[p]:i}return e}function Sn(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var bc=Ic(Ka),er=jp||function(e,t){return be.setTimeout(e,t)},Rn=Ic(Kd);function Ec(e,t,s){var c=t+"";return Rn(e,df(c,If(hf(c),s)))}function Ic(e){var t=0,s=0;return function(){var c=kp(),u=Hh-(c-s);if(s=c,u>0){if(++t>=Vh)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Xr(e,t){var s=-1,c=e.length,u=c-1;for(t=t===i?c:t;++s<t;){var p=cn(s,u),f=e[p];e[p]=e[s],e[s]=f}return e.length=t,e}var Pc=mf(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ll,function(s,c,u,p){t.push(u?p.replace(wl,"$1"):c||s)}),t});function gt(e){if(typeof e=="string"||He(e))return e;var t=e+"";return t=="0"&&1/e==-Yt?"-0":t}function ni(e){if(e!=null){try{return Cr.call(e)}catch{}try{return e+""}catch{}}return""}function If(e,t){return Qe(Qh,function(s){var c="_."+s[0];t&s[1]&&!Ir(e,c)&&e.push(c)}),e.sort()}function Sc(e){if(e instanceof K)return e.clone();var t=new Ye(e.__wrapped__,e.__chain__);return t.__actions__=qe(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Pf(e,t,s){(s?xe(e,t,s):t===i)?t=1:t=ve(k(t),0);var c=e==null?0:e.length;if(!c||t<1)return[];for(var u=0,p=0,f=_(qr(c/t));u<c;)f[p++]=Xe(e,u,u+=t);return f}function Sf(e){for(var t=-1,s=e==null?0:e.length,c=0,u=[];++t<s;){var p=e[t];p&&(u[c++]=p)}return u}function Rf(){var e=arguments.length;if(!e)return[];for(var t=_(e-1),s=arguments[0],c=e;c--;)t[c-1]=arguments[c];return Lt(M(s)?qe(s):[s],Ee(t,1))}var Of=V(function(e,t){return de(e)?Wi(e,Ee(t,1,de,!0)):[]}),Cf=V(function(e,t){var s=et(t);return de(s)&&(s=i),de(e)?Wi(e,Ee(t,1,de,!0),D(s,2)):[]}),Nf=V(function(e,t){var s=et(t);return de(s)&&(s=i),de(e)?Wi(e,Ee(t,1,de,!0),i,s):[]});function xf(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:k(t),Xe(e,t<0?0:t,c)):[]}function $f(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:k(t),t=c-t,Xe(e,0,t<0?0:t)):[]}function Tf(e,t){return e&&e.length?Fr(e,D(t,3),!0,!0):[]}function Af(e,t){return e&&e.length?Fr(e,D(t,3),!0):[]}function Df(e,t,s,c){var u=e==null?0:e.length;return u?(s&&typeof s!="number"&&xe(e,t,s)&&(s=0,c=u),Sd(e,t,s,c)):[]}function Rc(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var u=s==null?0:k(s);return u<0&&(u=ve(c+u,0)),Pr(e,D(t,3),u)}function Oc(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var u=c-1;return s!==i&&(u=k(s),u=s<0?ve(c+u,0):Pe(u,c-1)),Pr(e,D(t,3),u,!0)}function Cc(e){var t=e==null?0:e.length;return t?Ee(e,1):[]}function qf(e){var t=e==null?0:e.length;return t?Ee(e,Yt):[]}function jf(e,t){var s=e==null?0:e.length;return s?(t=t===i?1:k(t),Ee(e,t)):[]}function Uf(e){for(var t=-1,s=e==null?0:e.length,c={};++t<s;){var u=e[t];c[u[0]]=u[1]}return c}function Nc(e){return e&&e.length?e[0]:i}function Lf(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var u=s==null?0:k(s);return u<0&&(u=ve(c+u,0)),di(e,t,u)}function Mf(e){var t=e==null?0:e.length;return t?Xe(e,0,-1):[]}var kf=V(function(e){var t=oe(e,dn);return t.length&&t[0]===e[0]?rn(t):[]}),zf=V(function(e){var t=et(e),s=oe(e,dn);return t===et(s)?t=i:s.pop(),s.length&&s[0]===e[0]?rn(s,D(t,2)):[]}),Vf=V(function(e){var t=et(e),s=oe(e,dn);return t=typeof t=="function"?t:i,t&&s.pop(),s.length&&s[0]===e[0]?rn(s,i,t):[]});function Hf(e,t){return e==null?"":Lp.call(e,t)}function et(e){var t=e==null?0:e.length;return t?e[t-1]:i}function Kf(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var u=c;return s!==i&&(u=k(s),u=u<0?ve(c+u,0):Pe(u,c-1)),t===t?Ep(e,t,u):Pr(e,ua,u,!0)}function Ff(e,t){return e&&e.length?ka(e,k(t)):i}var Gf=V(xc);function xc(e,t){return e&&e.length&&t&&t.length?an(e,t):e}function Bf(e,t,s){return e&&e.length&&t&&t.length?an(e,t,D(s,2)):e}function Wf(e,t,s){return e&&e.length&&t&&t.length?an(e,t,i,s):e}var Qf=It(function(e,t){var s=e==null?0:e.length,c=Zs(e,t);return Ha(e,oe(t,function(u){return Pt(u,s)?+u:u}).sort(Xa)),c});function Jf(e,t){var s=[];if(!(e&&e.length))return s;var c=-1,u=[],p=e.length;for(t=D(t,3);++c<p;){var f=e[c];t(f,c,e)&&(s.push(f),u.push(c))}return Ha(e,u),s}function On(e){return e==null?e:Vp.call(e)}function Yf(e,t,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&xe(e,t,s)?(t=0,s=c):(t=t==null?0:k(t),s=s===i?c:k(s)),Xe(e,t,s)):[]}function Zf(e,t){return Kr(e,t)}function Xf(e,t,s){return hn(e,t,D(s,2))}function eg(e,t){var s=e==null?0:e.length;if(s){var c=Kr(e,t);if(c<s&&ct(e[c],t))return c}return-1}function tg(e,t){return Kr(e,t,!0)}function ig(e,t,s){return hn(e,t,D(s,2),!0)}function rg(e,t){var s=e==null?0:e.length;if(s){var c=Kr(e,t,!0)-1;if(ct(e[c],t))return c}return-1}function sg(e){return e&&e.length?Fa(e):[]}function ng(e,t){return e&&e.length?Fa(e,D(t,2)):[]}function og(e){var t=e==null?0:e.length;return t?Xe(e,1,t):[]}function ag(e,t,s){return e&&e.length?(t=s||t===i?1:k(t),Xe(e,0,t<0?0:t)):[]}function cg(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===i?1:k(t),t=c-t,Xe(e,t<0?0:t,c)):[]}function ug(e,t){return e&&e.length?Fr(e,D(t,3),!1,!0):[]}function hg(e,t){return e&&e.length?Fr(e,D(t,3)):[]}var lg=V(function(e){return Vt(Ee(e,1,de,!0))}),pg=V(function(e){var t=et(e);return de(t)&&(t=i),Vt(Ee(e,1,de,!0),D(t,2))}),dg=V(function(e){var t=et(e);return t=typeof t=="function"?t:i,Vt(Ee(e,1,de,!0),i,t)});function fg(e){return e&&e.length?Vt(e):[]}function gg(e,t){return e&&e.length?Vt(e,D(t,2)):[]}function yg(e,t){return t=typeof t=="function"?t:i,e&&e.length?Vt(e,i,t):[]}function Cn(e){if(!(e&&e.length))return[];var t=0;return e=Ut(e,function(s){if(de(s))return t=ve(s.length,t),!0}),Ks(t,function(s){return oe(e,zs(s))})}function $c(e,t){if(!(e&&e.length))return[];var s=Cn(e);return t==null?s:oe(s,function(c){return ke(t,i,c)})}var vg=V(function(e,t){return de(e)?Wi(e,t):[]}),mg=V(function(e){return pn(Ut(e,de))}),wg=V(function(e){var t=et(e);return de(t)&&(t=i),pn(Ut(e,de),D(t,2))}),_g=V(function(e){var t=et(e);return t=typeof t=="function"?t:i,pn(Ut(e,de),i,t)}),bg=V(Cn);function Eg(e,t){return Qa(e||[],t||[],Bi)}function Ig(e,t){return Qa(e||[],t||[],Yi)}var Pg=V(function(e){var t=e.length,s=t>1?e[t-1]:i;return s=typeof s=="function"?(e.pop(),s):i,$c(e,s)});function Tc(e){var t=l(e);return t.__chain__=!0,t}function Sg(e,t){return t(e),e}function es(e,t){return t(e)}var Rg=It(function(e){var t=e.length,s=t?e[0]:0,c=this.__wrapped__,u=function(p){return Zs(p,e)};return t>1||this.__actions__.length||!(c instanceof K)||!Pt(s)?this.thru(u):(c=c.slice(s,+s+(t?1:0)),c.__actions__.push({func:es,args:[u],thisArg:i}),new Ye(c,this.__chain__).thru(function(p){return t&&!p.length&&p.push(i),p}))});function Og(){return Tc(this)}function Cg(){return new Ye(this.value(),this.__chain__)}function Ng(){this.__values__===i&&(this.__values__=Gc(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function xg(){return this}function $g(e){for(var t,s=this;s instanceof Mr;){var c=Sc(s);c.__index__=0,c.__values__=i,t?u.__wrapped__=c:t=c;var u=c;s=s.__wrapped__}return u.__wrapped__=e,t}function Tg(){var e=this.__wrapped__;if(e instanceof K){var t=e;return this.__actions__.length&&(t=new K(this)),t=t.reverse(),t.__actions__.push({func:es,args:[On],thisArg:i}),new Ye(t,this.__chain__)}return this.thru(On)}function Ag(){return Wa(this.__wrapped__,this.__actions__)}var Dg=Gr(function(e,t,s){Y.call(e,s)?++e[s]:bt(e,s,1)});function qg(e,t,s){var c=M(e)?aa:Pd;return s&&xe(e,t,s)&&(t=i),c(e,D(t,3))}function jg(e,t){var s=M(e)?Ut:$a;return s(e,D(t,3))}var Ug=nc(Rc),Lg=nc(Oc);function Mg(e,t){return Ee(ts(e,t),1)}function kg(e,t){return Ee(ts(e,t),Yt)}function zg(e,t,s){return s=s===i?1:k(s),Ee(ts(e,t),s)}function Ac(e,t){var s=M(e)?Qe:zt;return s(e,D(t,3))}function Dc(e,t){var s=M(e)?np:xa;return s(e,D(t,3))}var Vg=Gr(function(e,t,s){Y.call(e,s)?e[s].push(t):bt(e,s,[t])});function Hg(e,t,s,c){e=je(e)?e:Si(e),s=s&&!c?k(s):0;var u=e.length;return s<0&&(s=ve(u+s,0)),os(e)?s<=u&&e.indexOf(t,s)>-1:!!u&&di(e,t,s)>-1}var Kg=V(function(e,t,s){var c=-1,u=typeof t=="function",p=je(e)?_(e.length):[];return zt(e,function(f){p[++c]=u?ke(t,f,s):Qi(f,t,s)}),p}),Fg=Gr(function(e,t,s){bt(e,s,t)});function ts(e,t){var s=M(e)?oe:Ua;return s(e,D(t,3))}function Gg(e,t,s,c){return e==null?[]:(M(t)||(t=t==null?[]:[t]),s=c?i:s,M(s)||(s=s==null?[]:[s]),za(e,t,s))}var Bg=Gr(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function Wg(e,t,s){var c=M(e)?Ms:la,u=arguments.length<3;return c(e,D(t,4),s,u,zt)}function Qg(e,t,s){var c=M(e)?op:la,u=arguments.length<3;return c(e,D(t,4),s,u,xa)}function Jg(e,t){var s=M(e)?Ut:$a;return s(e,ss(D(t,3)))}function Yg(e){var t=M(e)?Ra:Vd;return t(e)}function Zg(e,t,s){(s?xe(e,t,s):t===i)?t=1:t=k(t);var c=M(e)?wd:Hd;return c(e,t)}function Xg(e){var t=M(e)?_d:Fd;return t(e)}function ey(e){if(e==null)return 0;if(je(e))return os(e)?gi(e):e.length;var t=Se(e);return t==st||t==nt?e.size:nn(e).length}function ty(e,t,s){var c=M(e)?ks:Gd;return s&&xe(e,t,s)&&(t=i),c(e,D(t,3))}var iy=V(function(e,t){if(e==null)return[];var s=t.length;return s>1&&xe(e,t[0],t[1])?t=[]:s>2&&xe(t[0],t[1],t[2])&&(t=[t[0]]),za(e,Ee(t,1),[])}),is=qp||function(){return be.Date.now()};function ry(e,t){if(typeof t!="function")throw new Je(d);return e=k(e),function(){if(--e<1)return t.apply(this,arguments)}}function qc(e,t,s){return t=s?i:t,t=e&&t==null?e.length:t,Et(e,pe,i,i,i,i,t)}function jc(e,t){var s;if(typeof t!="function")throw new Je(d);return e=k(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=i),s}}var Nn=V(function(e,t,s){var c=se;if(s.length){var u=Mt(s,Ii(Nn));c|=B}return Et(e,c,t,s,u)}),Uc=V(function(e,t,s){var c=se|ee;if(s.length){var u=Mt(s,Ii(Uc));c|=B}return Et(t,c,e,s,u)});function Lc(e,t,s){t=s?i:t;var c=Et(e,ne,i,i,i,i,i,t);return c.placeholder=Lc.placeholder,c}function Mc(e,t,s){t=s?i:t;var c=Et(e,te,i,i,i,i,i,t);return c.placeholder=Mc.placeholder,c}function kc(e,t,s){var c,u,p,f,g,m,E=0,I=!1,P=!1,C=!0;if(typeof e!="function")throw new Je(d);t=tt(t)||0,ue(s)&&(I=!!s.leading,P="maxWait"in s,p=P?ve(tt(s.maxWait)||0,t):p,C="trailing"in s?!!s.trailing:C);function $(fe){var ut=c,Ot=u;return c=u=i,E=fe,f=e.apply(Ot,ut),f}function q(fe){return E=fe,g=er(H,t),I?$(fe):f}function z(fe){var ut=fe-m,Ot=fe-E,nu=t-ut;return P?Pe(nu,p-Ot):nu}function j(fe){var ut=fe-m,Ot=fe-E;return m===i||ut>=t||ut<0||P&&Ot>=p}function H(){var fe=is();if(j(fe))return F(fe);g=er(H,z(fe))}function F(fe){return g=i,C&&c?$(fe):(c=u=i,f)}function Ke(){g!==i&&Ja(g),E=0,c=m=u=g=i}function $e(){return g===i?f:F(is())}function Fe(){var fe=is(),ut=j(fe);if(c=arguments,u=this,m=fe,ut){if(g===i)return q(m);if(P)return Ja(g),g=er(H,t),$(m)}return g===i&&(g=er(H,t)),f}return Fe.cancel=Ke,Fe.flush=$e,Fe}var sy=V(function(e,t){return Na(e,1,t)}),ny=V(function(e,t,s){return Na(e,tt(t)||0,s)});function oy(e){return Et(e,qt)}function rs(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Je(d);var s=function(){var c=arguments,u=t?t.apply(this,c):c[0],p=s.cache;if(p.has(u))return p.get(u);var f=e.apply(this,c);return s.cache=p.set(u,f)||p,f};return s.cache=new(rs.Cache||_t),s}rs.Cache=_t;function ss(e){if(typeof e!="function")throw new Je(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function ay(e){return jc(2,e)}var cy=Bd(function(e,t){t=t.length==1&&M(t[0])?oe(t[0],ze(D())):oe(Ee(t,1),ze(D()));var s=t.length;return V(function(c){for(var u=-1,p=Pe(c.length,s);++u<p;)c[u]=t[u].call(this,c[u]);return ke(e,this,c)})}),xn=V(function(e,t){var s=Mt(t,Ii(xn));return Et(e,B,i,t,s)}),zc=V(function(e,t){var s=Mt(t,Ii(zc));return Et(e,me,i,t,s)}),uy=It(function(e,t){return Et(e,Ce,i,i,i,t)});function hy(e,t){if(typeof e!="function")throw new Je(d);return t=t===i?t:k(t),V(e,t)}function ly(e,t){if(typeof e!="function")throw new Je(d);return t=t==null?0:ve(k(t),0),V(function(s){var c=s[t],u=Kt(s,0,t);return c&&Lt(u,c),ke(e,this,u)})}function py(e,t,s){var c=!0,u=!0;if(typeof e!="function")throw new Je(d);return ue(s)&&(c="leading"in s?!!s.leading:c,u="trailing"in s?!!s.trailing:u),kc(e,t,{leading:c,maxWait:t,trailing:u})}function dy(e){return qc(e,1)}function fy(e,t){return xn(fn(t),e)}function gy(){if(!arguments.length)return[];var e=arguments[0];return M(e)?e:[e]}function yy(e){return Ze(e,J)}function vy(e,t){return t=typeof t=="function"?t:i,Ze(e,J,t)}function my(e){return Ze(e,O|J)}function wy(e,t){return t=typeof t=="function"?t:i,Ze(e,O|J,t)}function _y(e,t){return t==null||Ca(e,t,we(t))}function ct(e,t){return e===t||e!==e&&t!==t}var by=Jr(tn),Ey=Jr(function(e,t){return e>=t}),oi=Da(function(){return arguments}())?Da:function(e){return he(e)&&Y.call(e,"callee")&&!_a.call(e,"callee")},M=_.isArray,Iy=ta?ze(ta):xd;function je(e){return e!=null&&ns(e.length)&&!St(e)}function de(e){return he(e)&&je(e)}function Py(e){return e===!0||e===!1||he(e)&&Ne(e)==Di}var Ft=Up||zn,Sy=ia?ze(ia):$d;function Ry(e){return he(e)&&e.nodeType===1&&!tr(e)}function Oy(e){if(e==null)return!0;if(je(e)&&(M(e)||typeof e=="string"||typeof e.splice=="function"||Ft(e)||Pi(e)||oi(e)))return!e.length;var t=Se(e);if(t==st||t==nt)return!e.size;if(Xi(e))return!nn(e).length;for(var s in e)if(Y.call(e,s))return!1;return!0}function Cy(e,t){return Ji(e,t)}function Ny(e,t,s){s=typeof s=="function"?s:i;var c=s?s(e,t):i;return c===i?Ji(e,t,i,s):!!c}function $n(e){if(!he(e))return!1;var t=Ne(e);return t==vr||t==Yh||typeof e.message=="string"&&typeof e.name=="string"&&!tr(e)}function xy(e){return typeof e=="number"&&Ea(e)}function St(e){if(!ue(e))return!1;var t=Ne(e);return t==mr||t==No||t==Jh||t==Xh}function Vc(e){return typeof e=="number"&&e==k(e)}function ns(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jt}function ue(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function he(e){return e!=null&&typeof e=="object"}var Hc=ra?ze(ra):Ad;function $y(e,t){return e===t||sn(e,t,bn(t))}function Ty(e,t,s){return s=typeof s=="function"?s:i,sn(e,t,bn(t),s)}function Ay(e){return Kc(e)&&e!=+e}function Dy(e){if(vf(e))throw new L(h);return qa(e)}function qy(e){return e===null}function jy(e){return e==null}function Kc(e){return typeof e=="number"||he(e)&&Ne(e)==ji}function tr(e){if(!he(e)||Ne(e)!=mt)return!1;var t=Tr(e);if(t===null)return!0;var s=Y.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&Cr.call(s)==$p}var Tn=sa?ze(sa):Dd;function Uy(e){return Vc(e)&&e>=-jt&&e<=jt}var Fc=na?ze(na):qd;function os(e){return typeof e=="string"||!M(e)&&he(e)&&Ne(e)==Li}function He(e){return typeof e=="symbol"||he(e)&&Ne(e)==wr}var Pi=oa?ze(oa):jd;function Ly(e){return e===i}function My(e){return he(e)&&Se(e)==Mi}function ky(e){return he(e)&&Ne(e)==tl}var zy=Jr(on),Vy=Jr(function(e,t){return e<=t});function Gc(e){if(!e)return[];if(je(e))return os(e)?ot(e):qe(e);if(Vi&&e[Vi])return wp(e[Vi]());var t=Se(e),s=t==st?Gs:t==nt?Sr:Si;return s(e)}function Rt(e){if(!e)return e===0?e:0;if(e=tt(e),e===Yt||e===-Yt){var t=e<0?-1:1;return t*Gh}return e===e?e:0}function k(e){var t=Rt(e),s=t%1;return t===t?s?t-s:t:0}function Bc(e){return e?ii(k(e),0,pt):0}function tt(e){if(typeof e=="number")return e;if(He(e))return gr;if(ue(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ue(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=pa(e);var s=El.test(e);return s||Pl.test(e)?ip(e.slice(2),s?2:8):bl.test(e)?gr:+e}function Wc(e){return ft(e,Ue(e))}function Hy(e){return e?ii(k(e),-jt,jt):e===0?e:0}function Q(e){return e==null?"":Ve(e)}var Ky=bi(function(e,t){if(Xi(t)||je(t)){ft(t,we(t),e);return}for(var s in t)Y.call(t,s)&&Bi(e,s,t[s])}),Qc=bi(function(e,t){ft(t,Ue(t),e)}),as=bi(function(e,t,s,c){ft(t,Ue(t),e,c)}),Fy=bi(function(e,t,s,c){ft(t,we(t),e,c)}),Gy=It(Zs);function By(e,t){var s=_i(e);return t==null?s:Oa(s,t)}var Wy=V(function(e,t){e=X(e);var s=-1,c=t.length,u=c>2?t[2]:i;for(u&&xe(t[0],t[1],u)&&(c=1);++s<c;)for(var p=t[s],f=Ue(p),g=-1,m=f.length;++g<m;){var E=f[g],I=e[E];(I===i||ct(I,vi[E])&&!Y.call(e,E))&&(e[E]=p[E])}return e}),Qy=V(function(e){return e.push(i,pc),ke(Jc,i,e)});function Jy(e,t){return ca(e,D(t,3),dt)}function Yy(e,t){return ca(e,D(t,3),en)}function Zy(e,t){return e==null?e:Xs(e,D(t,3),Ue)}function Xy(e,t){return e==null?e:Ta(e,D(t,3),Ue)}function ev(e,t){return e&&dt(e,D(t,3))}function tv(e,t){return e&&en(e,D(t,3))}function iv(e){return e==null?[]:Vr(e,we(e))}function rv(e){return e==null?[]:Vr(e,Ue(e))}function An(e,t,s){var c=e==null?i:ri(e,t);return c===i?s:c}function sv(e,t){return e!=null&&gc(e,t,Rd)}function Dn(e,t){return e!=null&&gc(e,t,Od)}var nv=ac(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Nr.call(t)),e[t]=s},jn(Le)),ov=ac(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Nr.call(t)),Y.call(e,t)?e[t].push(s):e[t]=[s]},D),av=V(Qi);function we(e){return je(e)?Sa(e):nn(e)}function Ue(e){return je(e)?Sa(e,!0):Ud(e)}function cv(e,t){var s={};return t=D(t,3),dt(e,function(c,u,p){bt(s,t(c,u,p),c)}),s}function uv(e,t){var s={};return t=D(t,3),dt(e,function(c,u,p){bt(s,u,t(c,u,p))}),s}var hv=bi(function(e,t,s){Hr(e,t,s)}),Jc=bi(function(e,t,s,c){Hr(e,t,s,c)}),lv=It(function(e,t){var s={};if(e==null)return s;var c=!1;t=oe(t,function(p){return p=Ht(p,e),c||(c=p.length>1),p}),ft(e,wn(e),s),c&&(s=Ze(s,O|T|J,nf));for(var u=t.length;u--;)ln(s,t[u]);return s});function pv(e,t){return Yc(e,ss(D(t)))}var dv=It(function(e,t){return e==null?{}:Md(e,t)});function Yc(e,t){if(e==null)return{};var s=oe(wn(e),function(c){return[c]});return t=D(t),Va(e,s,function(c,u){return t(c,u[0])})}function fv(e,t,s){t=Ht(t,e);var c=-1,u=t.length;for(u||(u=1,e=i);++c<u;){var p=e==null?i:e[gt(t[c])];p===i&&(c=u,p=s),e=St(p)?p.call(e):p}return e}function gv(e,t,s){return e==null?e:Yi(e,t,s)}function yv(e,t,s,c){return c=typeof c=="function"?c:i,e==null?e:Yi(e,t,s,c)}var Zc=hc(we),Xc=hc(Ue);function vv(e,t,s){var c=M(e),u=c||Ft(e)||Pi(e);if(t=D(t,4),s==null){var p=e&&e.constructor;u?s=c?new p:[]:ue(e)?s=St(p)?_i(Tr(e)):{}:s={}}return(u?Qe:dt)(e,function(f,g,m){return t(s,f,g,m)}),s}function mv(e,t){return e==null?!0:ln(e,t)}function wv(e,t,s){return e==null?e:Ba(e,t,fn(s))}function _v(e,t,s,c){return c=typeof c=="function"?c:i,e==null?e:Ba(e,t,fn(s),c)}function Si(e){return e==null?[]:Fs(e,we(e))}function bv(e){return e==null?[]:Fs(e,Ue(e))}function Ev(e,t,s){return s===i&&(s=t,t=i),s!==i&&(s=tt(s),s=s===s?s:0),t!==i&&(t=tt(t),t=t===t?t:0),ii(tt(e),t,s)}function Iv(e,t,s){return t=Rt(t),s===i?(s=t,t=0):s=Rt(s),e=tt(e),Cd(e,t,s)}function Pv(e,t,s){if(s&&typeof s!="boolean"&&xe(e,t,s)&&(t=s=i),s===i&&(typeof t=="boolean"?(s=t,t=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&t===i?(e=0,t=1):(e=Rt(e),t===i?(t=e,e=0):t=Rt(t)),e>t){var c=e;e=t,t=c}if(s||e%1||t%1){var u=Ia();return Pe(e+u*(t-e+tp("1e-"+((u+"").length-1))),t)}return cn(e,t)}var Sv=Ei(function(e,t,s){return t=t.toLowerCase(),e+(s?eu(t):t)});function eu(e){return qn(Q(e).toLowerCase())}function tu(e){return e=Q(e),e&&e.replace(Rl,fp).replace(Fl,"")}function Rv(e,t,s){e=Q(e),t=Ve(t);var c=e.length;s=s===i?c:ii(k(s),0,c);var u=s;return s-=t.length,s>=0&&e.slice(s,u)==t}function Ov(e){return e=Q(e),e&&ol.test(e)?e.replace(To,gp):e}function Cv(e){return e=Q(e),e&&pl.test(e)?e.replace(Ns,"\\$&"):e}var Nv=Ei(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),xv=Ei(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),$v=sc("toLowerCase");function Tv(e,t,s){e=Q(e),t=k(t);var c=t?gi(e):0;if(!t||c>=t)return e;var u=(t-c)/2;return Qr(jr(u),s)+e+Qr(qr(u),s)}function Av(e,t,s){e=Q(e),t=k(t);var c=t?gi(e):0;return t&&c<t?e+Qr(t-c,s):e}function Dv(e,t,s){e=Q(e),t=k(t);var c=t?gi(e):0;return t&&c<t?Qr(t-c,s)+e:e}function qv(e,t,s){return s||t==null?t=0:t&&(t=+t),zp(Q(e).replace(xs,""),t||0)}function jv(e,t,s){return(s?xe(e,t,s):t===i)?t=1:t=k(t),un(Q(e),t)}function Uv(){var e=arguments,t=Q(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Lv=Ei(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function Mv(e,t,s){return s&&typeof s!="number"&&xe(e,t,s)&&(t=s=i),s=s===i?pt:s>>>0,s?(e=Q(e),e&&(typeof t=="string"||t!=null&&!Tn(t))&&(t=Ve(t),!t&&fi(e))?Kt(ot(e),0,s):e.split(t,s)):[]}var kv=Ei(function(e,t,s){return e+(s?" ":"")+qn(t)});function zv(e,t,s){return e=Q(e),s=s==null?0:ii(k(s),0,e.length),t=Ve(t),e.slice(s,s+t.length)==t}function Vv(e,t,s){var c=l.templateSettings;s&&xe(e,t,s)&&(t=i),e=Q(e),t=as({},t,c,lc);var u=as({},t.imports,c.imports,lc),p=we(u),f=Fs(u,p),g,m,E=0,I=t.interpolate||_r,P="__p += '",C=Bs((t.escape||_r).source+"|"+I.source+"|"+(I===Ao?_l:_r).source+"|"+(t.evaluate||_r).source+"|$","g"),$="//# sourceURL="+(Y.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jl+"]")+`
`;e.replace(C,function(j,H,F,Ke,$e,Fe){return F||(F=Ke),P+=e.slice(E,Fe).replace(Ol,yp),H&&(g=!0,P+=`' +
__e(`+H+`) +
'`),$e&&(m=!0,P+=`';
`+$e+`;
__p += '`),F&&(P+=`' +
((__t = (`+F+`)) == null ? '' : __t) +
'`),E=Fe+j.length,j}),P+=`';
`;var q=Y.call(t,"variable")&&t.variable;if(!q)P=`with (obj) {
`+P+`
}
`;else if(ml.test(q))throw new L(y);P=(m?P.replace(il,""):P).replace(rl,"$1").replace(sl,"$1;"),P="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(g?", __e = _.escape":"")+(m?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var z=ru(function(){return W(p,$+"return "+P).apply(i,f)});if(z.source=P,$n(z))throw z;return z}function Hv(e){return Q(e).toLowerCase()}function Kv(e){return Q(e).toUpperCase()}function Fv(e,t,s){if(e=Q(e),e&&(s||t===i))return pa(e);if(!e||!(t=Ve(t)))return e;var c=ot(e),u=ot(t),p=da(c,u),f=fa(c,u)+1;return Kt(c,p,f).join("")}function Gv(e,t,s){if(e=Q(e),e&&(s||t===i))return e.slice(0,ya(e)+1);if(!e||!(t=Ve(t)))return e;var c=ot(e),u=fa(c,ot(t))+1;return Kt(c,0,u).join("")}function Bv(e,t,s){if(e=Q(e),e&&(s||t===i))return e.replace(xs,"");if(!e||!(t=Ve(t)))return e;var c=ot(e),u=da(c,ot(t));return Kt(c,u).join("")}function Wv(e,t){var s=kh,c=zh;if(ue(t)){var u="separator"in t?t.separator:u;s="length"in t?k(t.length):s,c="omission"in t?Ve(t.omission):c}e=Q(e);var p=e.length;if(fi(e)){var f=ot(e);p=f.length}if(s>=p)return e;var g=s-gi(c);if(g<1)return c;var m=f?Kt(f,0,g).join(""):e.slice(0,g);if(u===i)return m+c;if(f&&(g+=m.length-g),Tn(u)){if(e.slice(g).search(u)){var E,I=m;for(u.global||(u=Bs(u.source,Q(Do.exec(u))+"g")),u.lastIndex=0;E=u.exec(I);)var P=E.index;m=m.slice(0,P===i?g:P)}}else if(e.indexOf(Ve(u),g)!=g){var C=m.lastIndexOf(u);C>-1&&(m=m.slice(0,C))}return m+c}function Qv(e){return e=Q(e),e&&nl.test(e)?e.replace($o,Ip):e}var Jv=Ei(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),qn=sc("toUpperCase");function iu(e,t,s){return e=Q(e),t=s?i:t,t===i?mp(e)?Rp(e):up(e):e.match(t)||[]}var ru=V(function(e,t){try{return ke(e,i,t)}catch(s){return $n(s)?s:new L(s)}}),Yv=It(function(e,t){return Qe(t,function(s){s=gt(s),bt(e,s,Nn(e[s],e))}),e});function Zv(e){var t=e==null?0:e.length,s=D();return e=t?oe(e,function(c){if(typeof c[1]!="function")throw new Je(d);return[s(c[0]),c[1]]}):[],V(function(c){for(var u=-1;++u<t;){var p=e[u];if(ke(p[0],this,c))return ke(p[1],this,c)}})}function Xv(e){return Id(Ze(e,O))}function jn(e){return function(){return e}}function em(e,t){return e==null||e!==e?t:e}var tm=oc(),im=oc(!0);function Le(e){return e}function Un(e){return ja(typeof e=="function"?e:Ze(e,O))}function rm(e){return La(Ze(e,O))}function sm(e,t){return Ma(e,Ze(t,O))}var nm=V(function(e,t){return function(s){return Qi(s,e,t)}}),om=V(function(e,t){return function(s){return Qi(e,s,t)}});function Ln(e,t,s){var c=we(t),u=Vr(t,c);s==null&&!(ue(t)&&(u.length||!c.length))&&(s=t,t=e,e=this,u=Vr(t,we(t)));var p=!(ue(s)&&"chain"in s)||!!s.chain,f=St(e);return Qe(u,function(g){var m=t[g];e[g]=m,f&&(e.prototype[g]=function(){var E=this.__chain__;if(p||E){var I=e(this.__wrapped__),P=I.__actions__=qe(this.__actions__);return P.push({func:m,args:arguments,thisArg:e}),I.__chain__=E,I}return m.apply(e,Lt([this.value()],arguments))})}),e}function am(){return be._===this&&(be._=Tp),this}function Mn(){}function cm(e){return e=k(e),V(function(t){return ka(t,e)})}var um=yn(oe),hm=yn(aa),lm=yn(ks);function su(e){return In(e)?zs(gt(e)):kd(e)}function pm(e){return function(t){return e==null?i:ri(e,t)}}var dm=cc(),fm=cc(!0);function kn(){return[]}function zn(){return!1}function gm(){return{}}function ym(){return""}function vm(){return!0}function mm(e,t){if(e=k(e),e<1||e>jt)return[];var s=pt,c=Pe(e,pt);t=D(t),e-=pt;for(var u=Ks(c,t);++s<e;)t(s);return u}function wm(e){return M(e)?oe(e,gt):He(e)?[e]:qe(Pc(Q(e)))}function _m(e){var t=++xp;return Q(e)+t}var bm=Wr(function(e,t){return e+t},0),Em=vn("ceil"),Im=Wr(function(e,t){return e/t},1),Pm=vn("floor");function Sm(e){return e&&e.length?zr(e,Le,tn):i}function Rm(e,t){return e&&e.length?zr(e,D(t,2),tn):i}function Om(e){return ha(e,Le)}function Cm(e,t){return ha(e,D(t,2))}function Nm(e){return e&&e.length?zr(e,Le,on):i}function xm(e,t){return e&&e.length?zr(e,D(t,2),on):i}var $m=Wr(function(e,t){return e*t},1),Tm=vn("round"),Am=Wr(function(e,t){return e-t},0);function Dm(e){return e&&e.length?Hs(e,Le):0}function qm(e,t){return e&&e.length?Hs(e,D(t,2)):0}return l.after=ry,l.ary=qc,l.assign=Ky,l.assignIn=Qc,l.assignInWith=as,l.assignWith=Fy,l.at=Gy,l.before=jc,l.bind=Nn,l.bindAll=Yv,l.bindKey=Uc,l.castArray=gy,l.chain=Tc,l.chunk=Pf,l.compact=Sf,l.concat=Rf,l.cond=Zv,l.conforms=Xv,l.constant=jn,l.countBy=Dg,l.create=By,l.curry=Lc,l.curryRight=Mc,l.debounce=kc,l.defaults=Wy,l.defaultsDeep=Qy,l.defer=sy,l.delay=ny,l.difference=Of,l.differenceBy=Cf,l.differenceWith=Nf,l.drop=xf,l.dropRight=$f,l.dropRightWhile=Tf,l.dropWhile=Af,l.fill=Df,l.filter=jg,l.flatMap=Mg,l.flatMapDeep=kg,l.flatMapDepth=zg,l.flatten=Cc,l.flattenDeep=qf,l.flattenDepth=jf,l.flip=oy,l.flow=tm,l.flowRight=im,l.fromPairs=Uf,l.functions=iv,l.functionsIn=rv,l.groupBy=Vg,l.initial=Mf,l.intersection=kf,l.intersectionBy=zf,l.intersectionWith=Vf,l.invert=nv,l.invertBy=ov,l.invokeMap=Kg,l.iteratee=Un,l.keyBy=Fg,l.keys=we,l.keysIn=Ue,l.map=ts,l.mapKeys=cv,l.mapValues=uv,l.matches=rm,l.matchesProperty=sm,l.memoize=rs,l.merge=hv,l.mergeWith=Jc,l.method=nm,l.methodOf=om,l.mixin=Ln,l.negate=ss,l.nthArg=cm,l.omit=lv,l.omitBy=pv,l.once=ay,l.orderBy=Gg,l.over=um,l.overArgs=cy,l.overEvery=hm,l.overSome=lm,l.partial=xn,l.partialRight=zc,l.partition=Bg,l.pick=dv,l.pickBy=Yc,l.property=su,l.propertyOf=pm,l.pull=Gf,l.pullAll=xc,l.pullAllBy=Bf,l.pullAllWith=Wf,l.pullAt=Qf,l.range=dm,l.rangeRight=fm,l.rearg=uy,l.reject=Jg,l.remove=Jf,l.rest=hy,l.reverse=On,l.sampleSize=Zg,l.set=gv,l.setWith=yv,l.shuffle=Xg,l.slice=Yf,l.sortBy=iy,l.sortedUniq=sg,l.sortedUniqBy=ng,l.split=Mv,l.spread=ly,l.tail=og,l.take=ag,l.takeRight=cg,l.takeRightWhile=ug,l.takeWhile=hg,l.tap=Sg,l.throttle=py,l.thru=es,l.toArray=Gc,l.toPairs=Zc,l.toPairsIn=Xc,l.toPath=wm,l.toPlainObject=Wc,l.transform=vv,l.unary=dy,l.union=lg,l.unionBy=pg,l.unionWith=dg,l.uniq=fg,l.uniqBy=gg,l.uniqWith=yg,l.unset=mv,l.unzip=Cn,l.unzipWith=$c,l.update=wv,l.updateWith=_v,l.values=Si,l.valuesIn=bv,l.without=vg,l.words=iu,l.wrap=fy,l.xor=mg,l.xorBy=wg,l.xorWith=_g,l.zip=bg,l.zipObject=Eg,l.zipObjectDeep=Ig,l.zipWith=Pg,l.entries=Zc,l.entriesIn=Xc,l.extend=Qc,l.extendWith=as,Ln(l,l),l.add=bm,l.attempt=ru,l.camelCase=Sv,l.capitalize=eu,l.ceil=Em,l.clamp=Ev,l.clone=yy,l.cloneDeep=my,l.cloneDeepWith=wy,l.cloneWith=vy,l.conformsTo=_y,l.deburr=tu,l.defaultTo=em,l.divide=Im,l.endsWith=Rv,l.eq=ct,l.escape=Ov,l.escapeRegExp=Cv,l.every=qg,l.find=Ug,l.findIndex=Rc,l.findKey=Jy,l.findLast=Lg,l.findLastIndex=Oc,l.findLastKey=Yy,l.floor=Pm,l.forEach=Ac,l.forEachRight=Dc,l.forIn=Zy,l.forInRight=Xy,l.forOwn=ev,l.forOwnRight=tv,l.get=An,l.gt=by,l.gte=Ey,l.has=sv,l.hasIn=Dn,l.head=Nc,l.identity=Le,l.includes=Hg,l.indexOf=Lf,l.inRange=Iv,l.invoke=av,l.isArguments=oi,l.isArray=M,l.isArrayBuffer=Iy,l.isArrayLike=je,l.isArrayLikeObject=de,l.isBoolean=Py,l.isBuffer=Ft,l.isDate=Sy,l.isElement=Ry,l.isEmpty=Oy,l.isEqual=Cy,l.isEqualWith=Ny,l.isError=$n,l.isFinite=xy,l.isFunction=St,l.isInteger=Vc,l.isLength=ns,l.isMap=Hc,l.isMatch=$y,l.isMatchWith=Ty,l.isNaN=Ay,l.isNative=Dy,l.isNil=jy,l.isNull=qy,l.isNumber=Kc,l.isObject=ue,l.isObjectLike=he,l.isPlainObject=tr,l.isRegExp=Tn,l.isSafeInteger=Uy,l.isSet=Fc,l.isString=os,l.isSymbol=He,l.isTypedArray=Pi,l.isUndefined=Ly,l.isWeakMap=My,l.isWeakSet=ky,l.join=Hf,l.kebabCase=Nv,l.last=et,l.lastIndexOf=Kf,l.lowerCase=xv,l.lowerFirst=$v,l.lt=zy,l.lte=Vy,l.max=Sm,l.maxBy=Rm,l.mean=Om,l.meanBy=Cm,l.min=Nm,l.minBy=xm,l.stubArray=kn,l.stubFalse=zn,l.stubObject=gm,l.stubString=ym,l.stubTrue=vm,l.multiply=$m,l.nth=Ff,l.noConflict=am,l.noop=Mn,l.now=is,l.pad=Tv,l.padEnd=Av,l.padStart=Dv,l.parseInt=qv,l.random=Pv,l.reduce=Wg,l.reduceRight=Qg,l.repeat=jv,l.replace=Uv,l.result=fv,l.round=Tm,l.runInContext=v,l.sample=Yg,l.size=ey,l.snakeCase=Lv,l.some=ty,l.sortedIndex=Zf,l.sortedIndexBy=Xf,l.sortedIndexOf=eg,l.sortedLastIndex=tg,l.sortedLastIndexBy=ig,l.sortedLastIndexOf=rg,l.startCase=kv,l.startsWith=zv,l.subtract=Am,l.sum=Dm,l.sumBy=qm,l.template=Vv,l.times=mm,l.toFinite=Rt,l.toInteger=k,l.toLength=Bc,l.toLower=Hv,l.toNumber=tt,l.toSafeInteger=Hy,l.toString=Q,l.toUpper=Kv,l.trim=Fv,l.trimEnd=Gv,l.trimStart=Bv,l.truncate=Wv,l.unescape=Qv,l.uniqueId=_m,l.upperCase=Jv,l.upperFirst=qn,l.each=Ac,l.eachRight=Dc,l.first=Nc,Ln(l,function(){var e={};return dt(l,function(t,s){Y.call(l.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),l.VERSION=n,Qe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){l[e].placeholder=l}),Qe(["drop","take"],function(e,t){K.prototype[e]=function(s){s=s===i?1:ve(k(s),0);var c=this.__filtered__&&!t?new K(this):this.clone();return c.__filtered__?c.__takeCount__=Pe(s,c.__takeCount__):c.__views__.push({size:Pe(s,pt),type:e+(c.__dir__<0?"Right":"")}),c},K.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),Qe(["filter","map","takeWhile"],function(e,t){var s=t+1,c=s==Co||s==Fh;K.prototype[e]=function(u){var p=this.clone();return p.__iteratees__.push({iteratee:D(u,3),type:s}),p.__filtered__=p.__filtered__||c,p}}),Qe(["head","last"],function(e,t){var s="take"+(t?"Right":"");K.prototype[e]=function(){return this[s](1).value()[0]}}),Qe(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");K.prototype[e]=function(){return this.__filtered__?new K(this):this[s](1)}}),K.prototype.compact=function(){return this.filter(Le)},K.prototype.find=function(e){return this.filter(e).head()},K.prototype.findLast=function(e){return this.reverse().find(e)},K.prototype.invokeMap=V(function(e,t){return typeof e=="function"?new K(this):this.map(function(s){return Qi(s,e,t)})}),K.prototype.reject=function(e){return this.filter(ss(D(e)))},K.prototype.slice=function(e,t){e=k(e);var s=this;return s.__filtered__&&(e>0||t<0)?new K(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==i&&(t=k(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},K.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},K.prototype.toArray=function(){return this.take(pt)},dt(K.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),u=l[c?"take"+(t=="last"?"Right":""):t],p=c||/^find/.test(t);u&&(l.prototype[t]=function(){var f=this.__wrapped__,g=c?[1]:arguments,m=f instanceof K,E=g[0],I=m||M(f),P=function(H){var F=u.apply(l,Lt([H],g));return c&&C?F[0]:F};I&&s&&typeof E=="function"&&E.length!=1&&(m=I=!1);var C=this.__chain__,$=!!this.__actions__.length,q=p&&!C,z=m&&!$;if(!p&&I){f=z?f:new K(this);var j=e.apply(f,g);return j.__actions__.push({func:es,args:[P],thisArg:i}),new Ye(j,C)}return q&&z?e.apply(this,g):(j=this.thru(P),q?c?j.value()[0]:j.value():j)})}),Qe(["pop","push","shift","sort","splice","unshift"],function(e){var t=Rr[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);l.prototype[e]=function(){var u=arguments;if(c&&!this.__chain__){var p=this.value();return t.apply(M(p)?p:[],u)}return this[s](function(f){return t.apply(M(f)?f:[],u)})}}),dt(K.prototype,function(e,t){var s=l[t];if(s){var c=s.name+"";Y.call(wi,c)||(wi[c]=[]),wi[c].push({name:t,func:s})}}),wi[Br(i,ee).name]=[{name:"wrapper",func:i}],K.prototype.clone=Wp,K.prototype.reverse=Qp,K.prototype.value=Jp,l.prototype.at=Rg,l.prototype.chain=Og,l.prototype.commit=Cg,l.prototype.next=Ng,l.prototype.plant=$g,l.prototype.reverse=Tg,l.prototype.toJSON=l.prototype.valueOf=l.prototype.value=Ag,l.prototype.first=l.prototype.head,Vi&&(l.prototype[Vi]=xg),l},yi=Op();Zt?((Zt.exports=yi)._=yi,js._=yi):be._=yi}).call(sr)})(uo,uo.exports);var R1=Object.defineProperty,O1=Object.defineProperties,C1=Object.getOwnPropertyDescriptors,Wu=Object.getOwnPropertySymbols,N1=Object.prototype.hasOwnProperty,x1=Object.prototype.propertyIsEnumerable,Qu=(a,r,i)=>r in a?R1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,hs=(a,r)=>{for(var i in r||(r={}))N1.call(r,i)&&Qu(a,i,r[i]);if(Wu)for(var i of Wu(r))x1.call(r,i)&&Qu(a,i,r[i]);return a},$1=(a,r)=>O1(a,C1(r));function Qt(a,r,i){var n;const o=ew(a);return((n=r.rpcMap)==null?void 0:n[o.reference])||`${S1}?chainId=${o.namespace}:${o.reference}&projectId=${i}`}function ui(a){return a.includes(":")?a.split(":")[1]:a}function Lh(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function T1(a,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const n=[];return i.forEach(o=>{const h=r.namespaces[o].accounts;n.push(...h)}),n}function Ju(a={},r={}){const i=Yu(a),n=Yu(r);return uo.exports.merge(i,n)}function Yu(a){var r,i,n,o;const h={};if(!hr(a))return h;for(const[d,y]of Object.entries(a)){const w=bo(d)?[d]:y.chains,S=y.methods||[],N=y.events||[],O=y.rpcMap||{},T=nr(d);h[T]=$1(hs(hs({},h[T]),y),{chains:Hn(w,(r=h[T])==null?void 0:r.chains),methods:Hn(S,(i=h[T])==null?void 0:i.methods),events:Hn(N,(n=h[T])==null?void 0:n.events),rpcMap:hs(hs({},O),(o=h[T])==null?void 0:o.rpcMap)})}return h}function A1(a){return a.includes(":")?a.split(":")[2]:a}function D1(a){const r={};for(const[i,n]of Object.entries(a)){const o=n.methods||[],h=n.events||[],d=n.accounts||[],y=bo(i)?[i]:n.chains?n.chains:Lh(n.accounts);r[i]={chains:y,methods:o,events:h,accounts:d}}return r}function Yn(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):(a=a.includes(":")?a.split(":")[1]:a,isNaN(Number(a))?a:Number(a))}const Mh={},ce=a=>Mh[a],Zn=(a,r)=>{Mh[a]=r};class q1{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=ui(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class j1{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(parseInt(r),i),this.chainId=parseInt(r),this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const n=i||Qt(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=parseInt(ui(i));r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,n;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class U1{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=ui(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class L1{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=ui(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class M1{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i),o=ui(i);r[o]=this.createHttpProvider(o,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class k1{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=ui(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class z1{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=ui(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new At(new Jt(n,ce("disableProviderPing")))}}class V1{constructor(r){this.name="near",this.namespace=r.namespace,this.events=ce("events"),this.client=ce("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Qt(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Dt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Qt(r,this.namespace);return typeof n>"u"?void 0:new At(new Jt(n,ce("disableProviderPing")))}}var H1=Object.defineProperty,K1=Object.defineProperties,F1=Object.getOwnPropertyDescriptors,Zu=Object.getOwnPropertySymbols,G1=Object.prototype.hasOwnProperty,B1=Object.prototype.propertyIsEnumerable,Xu=(a,r,i)=>r in a?H1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,ls=(a,r)=>{for(var i in r||(r={}))G1.call(r,i)&&Xu(a,i,r[i]);if(Zu)for(var i of Zu(r))B1.call(r,i)&&Xu(a,i,r[i]);return a},Xn=(a,r)=>K1(a,F1(r));class Ro{constructor(r){this.events=new vo,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:G.pino(G.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Gu})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Ro(r);return await i.initialize(),i}async request(r,i,n){const[o,h]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:ls({},r),chainId:`${o}:${h}`,topic:this.session.topic,expiry:n})}sendAsync(r,i,n,o){const h=new Date().getTime();this.request(r,n,o).then(d=>i(null,vs(h,d))).catch(d=>i(d,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:ae("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h;const d=D1(h.namespaces);this.namespaces=Ju(this.namespaces,d),this.persist("namespaces",this.namespaces)}).catch(h=>{if(h.message!==jh)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(vt(i)){for(const n of i)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await b1.init({logger:this.providerOpts.logger||Gu,relayUrl:this.providerOpts.relayUrl||E1,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>nr(i)))];Zn("client",this.client),Zn("events",this.events),Zn("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const n=T1(i,this.session),o=Lh(n),h=Ju(this.namespaces,this.optionalNamespaces),d=Xn(ls({},h[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new j1({namespace:d});break;case"solana":this.rpcProviders[i]=new U1({namespace:d});break;case"cosmos":this.rpcProviders[i]=new L1({namespace:d});break;case"polkadot":this.rpcProviders[i]=new q1({namespace:d});break;case"cip34":this.rpcProviders[i]=new M1({namespace:d});break;case"elrond":this.rpcProviders[i]=new k1({namespace:d});break;case"multiversx":this.rpcProviders[i]=new z1({namespace:d});break;case"near":this.rpcProviders[i]=new V1({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&vt(o)&&this.events.emit("accountsChanged",o.map(A1))}else if(n.name==="chainChanged"){const o=i.chainId,h=i.event.data,d=nr(o),y=Yn(o)!==Yn(h)?`${d}:${Yn(h)}`:o;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var n;const{namespaces:o}=i,h=(n=this.client)==null?void 0:n.session.get(r);this.session=Xn(ls({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",Xn(ls({},ae("USER_DISCONNECTED")),{data:r.topic}))}),this.on(Dt.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(r){const[i,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(d=>nr(d)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=nr(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){if(!this.namespaces)return;const[n,o]=this.validateChain(r);o&&(i||this.getProvider(n).setDefaultChain(o),this.namespaces[n]?this.namespaces[n].defaultChain=o:this.namespaces[`${n}:${o}`]?this.namespaces[`${n}:${o}`].defaultChain=o:this.namespaces[`${n}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${Bu}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${Bu}/${r}`)}}const W1=Ro,Q1="wc",J1="ethereum_provider",Y1=`${Q1}@2:${J1}:`,Z1="https://rpc.walletconnect.com/v1/",ho=["eth_sendTransaction","personal_sign"],X1=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],lo=["chainChanged","accountsChanged"],eE=["chainChanged","accountsChanged","message","disconnect","connect"];var tE=Object.defineProperty,iE=Object.defineProperties,rE=Object.getOwnPropertyDescriptors,eh=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,nE=Object.prototype.propertyIsEnumerable,th=(a,r,i)=>r in a?tE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,ar=(a,r)=>{for(var i in r||(r={}))sE.call(r,i)&&th(a,i,r[i]);if(eh)for(var i of eh(r))nE.call(r,i)&&th(a,i,r[i]);return a},ih=(a,r)=>iE(a,rE(r));function ys(a){return Number(a[0].split(":")[1])}function eo(a){return`0x${a.toString(16)}`}function oE(a){const{chains:r,optionalChains:i,methods:n,optionalMethods:o,events:h,optionalEvents:d,rpcMap:y}=a;if(!vt(r))throw new Error("Invalid chains");const w={chains:r,methods:n||ho,events:h||lo,rpcMap:ar({},r.length?{[ys(r)]:y[ys(r)]}:{})},S=h==null?void 0:h.filter(J=>!lo.includes(J)),N=n==null?void 0:n.filter(J=>!ho.includes(J));if(!i&&!d&&!o&&!(S!=null&&S.length)&&!(N!=null&&N.length))return{required:r.length?w:void 0};const O=(S==null?void 0:S.length)&&(N==null?void 0:N.length)||!i,T={chains:[...new Set(O?w.chains.concat(i||[]):i)],methods:[...new Set(w.methods.concat(o!=null&&o.length?o:X1))],events:[...new Set(w.events.concat(d!=null&&d.length?d:eE))],rpcMap:y};return{required:r.length?w:void 0,optional:i.length?T:void 0}}class Oo{constructor(){this.events=new Tt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Y1,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new Oo;return await i.initialize(r),i}async request(r,i){return await this.signer.request(r,this.formatChainId(this.chainId),i)}sendAsync(r,i,n){this.signer.sendAsync(r,i,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:n}=oE(this.rpc);try{const o=await new Promise(async(d,y)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(S=>{!S.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ih(ar({namespaces:ar({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(S=>{d(S)}).catch(S=>{y(new Error(S.message))})});if(!o)return;const h=tw(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:eo(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",eo(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",ih(ar({},ae("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",eo(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,n,o]=r.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,n;const o=(i=r==null?void 0:r.chains)!=null?i:[],h=(n=r==null?void 0:r.optionalChains)!=null?n:[],d=o.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=o.length?(r==null?void 0:r.methods)||ho:[],w=o.length?(r==null?void 0:r.events)||lo:[],S=(r==null?void 0:r.optionalMethods)||[],N=(r==null?void 0:r.optionalEvents)||[],O=(r==null?void 0:r.rpcMap)||this.buildRpcMap(d,r.projectId),T=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(J=>this.formatChainId(J)),optionalChains:h.map(J=>this.formatChainId(J)),methods:y,events:w,optionalMethods:S,optionalEvents:N,rpcMap:O,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:T,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?ys(this.rpc.chains):ys(this.rpc.optionalChains),this.signer=await W1.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await Jm(()=>import("./index-PbSghA_E.js").then(o=>o.i),__vite__mapDeps([0,1,2]));i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(ar({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:n,rpcMap:o}=r;i&&vt(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&vt(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(r,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${Z1}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const vE=Oo;export{vE as EthereumProvider,eE as OPTIONAL_EVENTS,X1 as OPTIONAL_METHODS,lo as REQUIRED_EVENTS,ho as REQUIRED_METHODS,Oo as default};
